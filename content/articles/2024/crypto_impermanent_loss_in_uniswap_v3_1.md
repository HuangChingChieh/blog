---
title: Uniswap v3中的無常損失：摘要與前言
img: 922/6v2E92.jpg
tags: [DeFi, 投資, 流動性挖礦, 加密貨幣, uniswap v3, uniswap]
category: life
---

此系列文章翻譯自 Topaze Blue 和 Bancor Protocol 在 2021 年 11 月 17 日發布的一份報告：[《Impermanent Loss in Uniswap v3》](https://arxiv.org/pdf/2111.09192.pdf)。作者分別為：

- [Stefan Loesch](mailto:stefan@topaze.blue)
- [Nate Hindman](mailto:nate@bancor.network)
- [Nicholas Welch](mailto:nick@bancor.network)
- [Mark B. Richardson](mailto:mark@bancor.network)

<!--more-->

譯文中會穿插自己看不懂而上網查到的專有名詞解釋或是筆記，請斟酌服用。

---

## 摘要

自動做市商（Automated Market Makers, AMMs）是部署在區塊鏈上的智能合約，能夠自動在鏈上兩個不同資產之間造市。在這份報告中，我們研究特定種類的自動做市商：恆定函數做市商（Constant Function Market Makers, CFMMs），其交易狀況（忽略手續費收入）由其**聯合曲線**確定，例如 `𝑘 = 𝑥 * 𝑦`。

<article-note>聯合曲線（bonding curve）：用來描述價格與資產供給之間關係的數學概念。參考[《What Is a Bonding Curve?》](https://coinmarketcap.com/academy/glossary/bonding-curve)。</article-note>

這類自動做市商會受到無常損失（Impermanent Loss, IL）的影響，我們之前已將無常損失確認為與自動做市商相關的自我融資交易策略中的 Gamma 指標，也就是流動性提供者賺取潛在的手續費收入時承擔的風險。

<article-note>自我融資交易策略（self-financing trading strategy）：是指除了初始投資之外，在投資過程中，不追加任何投資，也不從投資中轉移資本，只通過資產組合本身的收益變動情況進行資產組合的結構調整。**這邊猜想是在說流動性挖礦隨著資產價格變動而自動調整流動性比例的行為。**</article-note>

> <small>這段對於非金融背景的人來說有夠天書，上網查了一些資料後個人的理解是這樣：簡單來說，無常損失的多寡決定了你的流動性倉位承受的風險大小。</small>
>
> <small>Delta 描述了資產價格變動時衍生品價格變動的幅度，而 Gamma 描述了資產價格變動時 Delta 變動的幅度。也就是說若 Gamma 為正值，則當一個資產價格變動越大時，衍生品價格受到影響的幅度也會變大。</small>
>
> <small>我們提供的流動性其實可以視為是幣的金融衍生品，當幣價漲跌越多，無常損失也會越來越大（導致流動性倉位的價值波動越大），因此無常損失可以看做是 v3 中流動性挖礦的 Gamma 指標。</small>

Uniswap v3 提出了將流動性放大的概念：藉由縮小流動性的交易範圍、降低未使用的流動性以實現更好的資本效率。這增加了所賺取的交易手續費，但也增加了風險：即無常損失。Uniswap v3 上的手續費等級已公開，因此在本文中，我們專注於計算無常損失。

在我們分析的 17 個流動性池中——這些池涵蓋了 43% 的總鎖倉價值（TVL），我們根據其規模、幣種和資料可取得程度進行篩選——從池建立至我們研究設定的截止日期間，流動性賺取的總費用為 1.993 億美元，同時流動性提供者遭受到的無常損失總額為 2.601 億美元。這意味著整體而言，這些流動性提供者如果只是持有資產本身（HODL），將會少虧損 60.8 百萬美元。

接下來，我們嘗試確定是否特定種類的使用者表現會更好。我們的第一個假設是，經常調整其流動性倉位的使用者將會比不這樣做的使用者有更好的收益，但我們找不到有統計意義的證據支持這個假設。我們檢查了流動性倉位活躍的時間範圍後發現，除了在有效區間中的閃電流動性之外，其他時間區間都會虧損。

<article-note>閃電流動性（flash liquidity）：也稱為 just-in-time liquidity。是指在交易之前提供、吸收特定交易的手續費後立刻移除倉位的流動性。可參考：[Just-In-Time Liquidity on the Uniswap Protocol](https://blog.uniswap.org/jit-liquidity)。此為作者在之後的段落會解釋的名詞，這邊先放上來。）</article-note>

然而，我們注意到了一個趨勢，即長期流動性儘管在計算無常損失後並未賺錢，但其表現優於短期流動性。持倉時間超過 1 個月的流動性其無常損失是手續費的 1.1 倍，而持倉時間最長不超過一天的流動性其無常損失則是手續費的 1.8 倍。一些議題需要進一步研究，尤其是是否存在能夠持續優於僅持有資產的中期流動性提供策略，或者正如諺語所言：「買入並持有而非擇時交易」才是最佳策略。

---

## 前言

Uniswap 於 2021 年 3 月發布了第 3 版本，該版本推廣並商業化了放大（或稱集中）流動性的概念。Uniswap V3 是對放大流動性概念的巧妙重塑，但它並非首例，在它之前已有在 Curve Finance v1 中引入的 StableSwap，以及 Bancor v2.0「放大流動性」問世。在集中流動性框架中計算無常損失很複雜，因為它必須同時考慮引入的槓桿以及價格範圍之外的無常損失，這並不存在於傳統的自動做市商中。

我們在研究中將無常損失的定義擴展到槓桿做市商，引入了最小無常損失和實際無常損失的概念、推導對應的計算公式，並將其應用到 Uniswap V3 上，分析了幣種間相關性低（例如非穩定幣交易對）和總鎖倉價值大於 1,000 萬美元的流動性池，它們在我們研究期間佔了 Uniswap V3 總鎖倉價值的 43%。我們先根據流動性價值的多寡篩選，如果無法取得其外部價格數據便將其排除。

我們的主要發現是，整體而言，幾乎所有流動性池的最小無常損失和實際損失都超過了在此期間賺取的手續費。換句話說，平均而言在 Uniswap v3 生態系統中，流動性提供者都是虧損的，單純持有資產（HODLing）將會更容易獲利。

重要的是，這個結論似乎廣泛適用。我們收集的證據表明，無論是經驗不足的散戶還是精通幣圈的專業人士，在此模式下都難以獲利，唯一的例外是「閃電流動性提供者」，他們在一個價格區間中提供流動性，吸收即將到來的交易手續費，然後立刻移除他們的流動性倉位。這些人在沒有承擔無常損失的情況下賺取了約 127 萬美元的手續費。

自問世以來，自動做市商——具體來說是常數乘積自動做市商——的總鎖定價值和手續費收入顯著增長。在其中提供流動性的主要風險是無常損失，我們將在下一節中詳細討論。市場上出現了幾種新的自動做市商設計來應對這一關鍵痛點：Balancer 試圖通過多資產池和可變權重來限制無常損失、Curve 強化了常數乘積功能並將其主要活動集中在穩定資產上以限制無常損失、Thorchain 使用可變費率結構，而 Bancor v2.1 提供了協議層級的無常損失保險。

就交易量和手續費而言，Uniswap v2 是所有自動做市商中最成功的。Uniswap v3 於 2021 年 3 月發布其白皮書，並於 2021 年 5 月推出，重點放在「放大」（或「集中」）流動性上。這個新模型引起了散戶和專業人士的強烈關注。值得注意的是，Uniswap v3 為次級 DeFi 協議提供了良好的基底，這些協議主要透過受放大流動性典範啟發的新策略建立可靠的收入來源。

Uniswap v3 推出後的表現令人印象深刻。在我們分析的流動性池中，從 2021 年 5 月 5 日至 2021 年 9 月 20 日，Uniswap 產生了超過 1,085 億美元的交易量，並從中獲得了總額 199.3 百萬美元的手續費收入。然而，人們常常忘記的是，自動做市商賺取的手續費並不是無償的，它們是對風險——特別是無常損失風險——的補償。雖然賺取了 1.993 億美元的手續費，但根據我們的計算，同期分析的流動性池遭受了超過 2.601 億美元的無常損失，使得將近一半（49.5％）的流動性提供者出現虧損。據我們所知，迄今為止業界尚未對 Uniswap v3 流動性提供者遭受的無常損失進行系統性研究，而這正是我們此篇報告的重點。

本文分為以下幾個章節：

在前言後，我們將回顧自動做市商和恆定函數做市商的概念，特別聚焦於無常損失。接著，我們將理論框架擴展到 Uniswap v3 所代表的放大（集中）型自動做市商。在第四章中，我們會介紹一些整體以及流動性池級的描述性統計數據，以更深入了解自動做市商系統。

第五章和第六章是此報告的核心：我們首先分析了各個流動性池的無常損失，並將其與對應的手續費等級進行比較，以了解流動性提供者是否從他們的作法中獲利。在最後一章（第六章），我們觀察了投資回報率（ROIs）和其他損益指標，包括賺錢／虧錢的流動性提供者比例以及他們的平均報酬。
