<!DOCTYPE html><html  lang="zh-Hant-TW" data-bs-theme="dark" data-capo=""><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>設定PM2來管理Nuxt SSR網站｜隨機手札</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<script async defer src="https://www.googletagmanager.com/gtag/js?id=G-KHMFPTGCC2"></script>
<script>window.dataLayer = window.dataLayer || []
          function gtag() {
            dataLayer.push(arguments)
          }
          gtag('js', new Date())
    
          gtag('config', 'G-KHMFPTGCC2')</script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100..900&display=swap">
<link rel="stylesheet" href="/blog/_nuxt/entry.BTCJ8Jjq.css" crossorigin>
<link rel="stylesheet" href="/blog/_nuxt/default.DtT6kygS.css" crossorigin>
<link rel="stylesheet" href="/blog/_nuxt/_slug_.BZ_bvq5W.css" crossorigin>
<link rel="stylesheet" href="/blog/_nuxt/articles-list-pick-container.3LBDKlOS.css" crossorigin>
<link rel="stylesheet" href="/blog/_nuxt/article-code.BjFTcNCv.css" crossorigin>
<link rel="stylesheet" href="/blog/_nuxt/article-note.Dcd9CN8P.css" crossorigin>
<link rel="preload" as="fetch" crossorigin="anonymous" href="/blog/vue_stack_deployment_pm2/_payload.json?84f3c8ff-4e09-4330-9879-b8a7aebb6bd3">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/CPhszLNW.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/D8Fv5cly.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/CPJOsjf1.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/BrlVDiOT.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/qKWlcrez.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/BAmjbylK.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DjKZ4lH-.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/jIl-TGEF.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/BMitxO_j.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/Cm2spptU.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/CO144XGK.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/C-v3KzvZ.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/CxYJgpPD.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/R6ZO-XoU.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DosZBHRb.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/HMm6VtTo.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/2Mm5daGw.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ngxeemWy.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DBoYbG6_.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/BEzBN8Bv.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/Bge6iN4h.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/D0Vs5Pro.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/CkG7H5JJ.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DCjskA5e.js">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/B9K5rw8f.js">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/DwOMVJL4.js">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/Cpj98o6Y.js">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/CFORz_ND.js">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/BBJlBWJ8.js">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="format-detection" content="telephone=no">
<meta property="og:site_name" content="隨機手札">
<meta property="og:locale" content="zh_TW">
<meta name="apple-mobile-web-app-title" content="隨機手札">
<link rel="icon" href="https://huangchingchieh.github.io/blog/favicon.ico">
<link rel="apple-touch-icon" href="https://huangchingchieh.github.io/blog//pwa-192x192.png">
<link rel="mask-icon" href="https://huangchingchieh.github.io/blog//maskable-icon-512x512.png">
<link rel="manifest" href="/blog/manifest.webmanifest">
<meta name="description" content="最近想整理一下自己在工作中用到的工具集，回頭看發現比較不熟的是 pm2 的初始設定，畢竟設定好之後也只會用到pm2 status、pm2 logs、pm2 monit……這些維護用的指令而已，就決定先從 pm2 開始紀錄了。">
<meta property="og:url" content="https://huangchingchieh.github.io/blog/vue_stack_deployment_pm2/">
<meta property="og:type" content="article">
<meta property="og:title" content="設定PM2來管理Nuxt SSR網站">
<meta property="og:description" content="最近想整理一下自己在工作中用到的工具集，回頭看發現比較不熟的是 pm2 的初始設定，畢竟設定好之後也只會用到pm2 status、pm2 logs、pm2 monit……這些維護用的指令而已，就決定先從 pm2 開始紀錄了。">
<meta property="og:image" content="https://imagizer.imageshack.com/v2/1600x1200q100/924/Crirxh.jpg">
<meta property="og:article:published_time" content="2024-06-02T02:55:15.000Z">
<meta property="og:article:modified_time" content="2024-06-02T02:55:15.000Z">
<meta property="og:article:tag" content="nuxt">
<meta property="og:article:tag" content="vue">
<meta property="og:article:tag" content="pm2">
<script type="application/ld+json" data-hid="a71723a">{"@context":"https://schema.org","@type":"BlogPosting","headline":"設定PM2來管理Nuxt SSR網站","image":["https://imagizer.imageshack.com/v2/1600x1200q100/924/Crirxh.jpg"],"datePublished":"2024-06-02T02:55:15.000Z","dateModified":"2024-06-02T02:55:15.000Z","author":[{"@type":"Person","name":"HuangChingChieh","url":"https://huangchingchieh.github.io/"}]}</script>
<script type="module" src="/blog/_nuxt/CPhszLNW.js" crossorigin></script>
<script id="unhead:payload" type="application/json">{"title":"隨機手札","titleTemplate":"%s｜隨機手札"}</script></head><body><div id="__nuxt"><!--[--><!----><!--[--><div class="d-none d-lg-block"></div><header class="_header_bi43o_6 _shrink_bi43o_45 border-bottom border-primary border-2 position-fixed shadow-sm bg-foreground w-100"><div class="container-md _container_bi43o_7 d-flex flex-row align-items-center"><!--[--><img src="/blog/pwa-64x64.png" height="64" width="64" class="common-icon rounded-circle shadow-sm bordered _bordered_t6qrn_2 _logo_bi43o_2"><div class="ms-3 flex-grow-1"><a href="/blog/" class="fw-bold text-body d-block text-decoration-none"> 隨機手札 </a><small class="text-muted _hint_bi43o_25">雜七雜八之地</small></div><div class="d-flex align-items-center justify-content-end"><div><button class="btn-link btn d-flex align-items-center text-decoration-none ms-3 ms-lg-4 d-flex p-0" type="button" title="文章分類"><!--[--><i class="bi-folder h5 mb-0 d-flex"></i><span class="ps-1"><!--[--><!--]--></span><!--]--></button><span></span></div><div style="display:none;"><button class="btn-link btn d-flex align-items-center text-decoration-none ms-3 ms-lg-4 d-flex p-0" type="button" title="文章摘要"><!--[--><i class="bi-card-list h5 mb-0 d-flex"></i><span class="ps-1"><!--[--><!--]--></span><!--]--></button><span></span></div><button class="btn-link btn d-flex align-items-center text-decoration-none ms-3 ms-lg-4 d-flex p-0" type="button"><!--[--><i class="bi-moon-stars h5 mb-0 d-flex"></i><span class="ps-1"><!--[--><!--]--></span><!--]--></button><div><button class="btn-link btn d-flex align-items-center text-decoration-none ms-3 ms-lg-4 d-flex p-0" type="button" title="搜尋文章"><!--[--><i class="bi-search h5 mb-0 d-flex"></i><span class="ps-1"><!--[--><!--]--></span><!--]--></button><span></span></div></div><!--]--></div></header><div class="_container_16ffe_2 mt-0 mt-lg-4"><main class="container-md py-4"><!--[--><!--[--><div class="col-lg-10 col-xl-8 col-12 mx-auto"><!--[--><div class="p-md-5 _container_1s3jf_3"><!--[--><article class="_article_13jpp_2"><h1 class="_title_13jpp_5">設定PM2來管理Nuxt SSR網站</h1><div class="d-flex flex-row align-items-center my-2"><time class="d-flex align-items-center flex-row text-muted small mb-0 _date_13jpp_11 me-3"><!--[--><i class="bi-calendar-event me-1"></i><span>2024/06/02</span><!--]--></time><span class="text-muted small d-inline-flex align-items-center me-3"><i class="bi-clock me-1"></i><span>4 min</span></span><a href="/blog/category/frontend/1/" class="text-muted small d-inline-flex align-items-center"><i class="bi-folder me-1"></i><span>前端筆記</span></a></div><div class="_tags_13jpp_14 d-flex flex-wrap my-2"><!--[--><span class="badge bg-secondary text-bg-secondary d-inline-block fw-normal font-monospace me-1 mb-1"><!--[--> #<!--[-->nuxt<!--]--><!--]--></span><span class="badge bg-secondary text-bg-secondary d-inline-block fw-normal font-monospace me-1 mb-1"><!--[--> #<!--[-->vue<!--]--><!--]--></span><span class="badge bg-secondary text-bg-secondary d-inline-block fw-normal font-monospace me-1 mb-1"><!--[--> #<!--[-->pm2<!--]--><!--]--></span><!--]--></div><div class="position-relative rounded _banner_13jpp_17"><picture><!--[--><!--]--><img class="_img_5u372_2 rounded" src="https://imagizer.imageshack.com/v2/640x480q70/924/Crirxh.jpg" loading="lazy"></picture></div><div class="nuxt-content"><p><!--[-->最近想整理一下自己在工作中用到的工具集，回頭看發現比較不熟的是 pm2 的初始設定，畢竟設定好之後也只會用到<code class=""><!--[-->pm2 status<!--]--></code>、<code class=""><!--[-->pm2 logs<!--]--></code>、<code class=""><!--[-->pm2 monit<!--]--></code>……這些維護用的指令而已，就決定先從 pm2 開始紀錄了。<!--]--></p><p><!--[-->文章內容都是官方文件就有的東西，這邊是取自己比較常用的部份，可能會延遲更新，還請訪客以<a href="https://pm2.keymetrics.io/docs/usage/quick-start/" target="_blank" rel="noopener noreferrer nofollow"><!--[--><!--[-->官方文件<!--]--><!--]--></a>為準。<!--]--></p><hr><h2 id="什麼是-pm2"><!--[-->什麼是 PM2<!--]--></h2><p><!--[-->需要使用即時 SSR 功能的 Nuxt 網站必須跑在 node 環境中成為一個 process，而 pm2 顧名思義就是拿來管理這個 process 的管理器（manager）。<!--]--></p><p><!--[-->這個管理器有滿多功能，像是主機重開機時自動重新啟動網站、自動將網站的 process 叢集化以達到可用的最大效能、紀錄 log、監控即時的效能資源耗損……等等，比起直接讓網站<code class=""><!--[-->npm run start<!--]--></code>來說，會方便許多。<!--]--></p><hr><h2 id="安裝"><!--[-->安裝<!--]--></h2><p><!--[-->可以透過 npm 直接安裝：<!--]--></p><div class="position-relative language-bash shiki shiki-themes github-dark" code="sudo npm install pm2@latest -g
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#B392F0">sudo</span><span style="--shiki-default:#9ECBFF"> npm</span><span style="--shiki-default:#9ECBFF"> install</span><span style="--shiki-default:#9ECBFF"> pm2@latest</span><span style="--shiki-default:#79B8FF"> -g
</span></span></code><!--]--></pre></div></div><p class="article-note small px-3 py-2 rounded align-middle shadow-sm"><i class="bi-lightbulb me-1"></i><!--[-->
這裡會有
<code class=""><!--[-->sudo<!--]--></code>
是因為自己工作中是透過 linux 的軟體包管理器來安裝 nodejs，若要全域安裝會需要管理員權限。
<!--]--></p><hr><h2 id="設定與執行"><!--[-->設定與執行<!--]--></h2><p><!--[-->透過建立<code class=""><!--[-->ecosystem.config.js<!--]--></code>檔案（Nuxt3 中為<code class=""><!--[-->ecosystem.config.cjs<!--]--></code>）可以控制 pm2 執行網站時的一些設定值，基本內容如下：<!--]--></p><div class="position-relative language-js shiki shiki-themes github-dark" code="module.exports = {
  apps: [
    {
      name: &#39;NuxtAppName&#39;,
      exec_mode: &#39;cluster&#39;,
      instances: &#39;max&#39;,
      /* Nuxt3 */
      // port: &#39;3000&#39;,
      // script: &#39;./.output/server/index.mjs&#39;,
      /* Nuxt2 */
      script: &#39;./node_modules/nuxt/bin/nuxt.js&#39;,
      args: &#39;start&#39;,
    },
  ],
}
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#79B8FF">module</span><span style="--shiki-default:#E1E4E8">.</span><span style="--shiki-default:#79B8FF">exports</span><span style="--shiki-default:#F97583"> =</span><span style="--shiki-default:#E1E4E8"> {
</span></span><span class="line" line="2"><span style="--shiki-default:#E1E4E8">  apps: [
</span></span><span class="line" line="3"><span style="--shiki-default:#E1E4E8">    {
</span></span><span class="line" line="4"><span style="--shiki-default:#E1E4E8">      name: </span><span style="--shiki-default:#9ECBFF">&#39;NuxtAppName&#39;</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="5"><span style="--shiki-default:#E1E4E8">      exec_mode: </span><span style="--shiki-default:#9ECBFF">&#39;cluster&#39;</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="6"><span style="--shiki-default:#E1E4E8">      instances: </span><span style="--shiki-default:#9ECBFF">&#39;max&#39;</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="7"><span style="--shiki-default:#6A737D">      /* Nuxt3 */
</span></span><span class="line" line="8"><span style="--shiki-default:#6A737D">      // port: &#39;3000&#39;,
</span></span><span class="line" line="9"><span style="--shiki-default:#6A737D">      // script: &#39;./.output/server/index.mjs&#39;,
</span></span><span class="line" line="10"><span style="--shiki-default:#6A737D">      /* Nuxt2 */
</span></span><span class="line" line="11"><span style="--shiki-default:#E1E4E8">      script: </span><span style="--shiki-default:#9ECBFF">&#39;./node_modules/nuxt/bin/nuxt.js&#39;</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="12"><span style="--shiki-default:#E1E4E8">      args: </span><span style="--shiki-default:#9ECBFF">&#39;start&#39;</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="13"><span style="--shiki-default:#E1E4E8">    },
</span></span><span class="line" line="14"><span style="--shiki-default:#E1E4E8">  ],
</span></span><span class="line" line="15"><span style="--shiki-default:#E1E4E8">}
</span></span></code><!--]--></pre></div></div><p><!--[-->接著在網站資料夾中執行下面這個指令，pm2 就會開始執行 Nuxt 網站了：<!--]--></p><div class="position-relative language-bash shiki shiki-themes github-dark" code="pm2 start ecosystem.config.js
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#B392F0">pm2</span><span style="--shiki-default:#9ECBFF"> start</span><span style="--shiki-default:#9ECBFF"> ecosystem.config.js
</span></span></code><!--]--></pre></div></div><h3 id="自己常用的其他設定"><!--[-->自己常用的其他設定<!--]--></h3><p><!--[-->當然<code class=""><!--[-->ecosystem.config.js<!--]--></code>還可以設定更多的參數，自己常用的羅列如下：<!--]--></p><div class="position-relative language-js shiki shiki-themes github-dark" code="module.exports = {
  apps: [
    {
      // 設定不同環境時的參數，可以區分開發、測試以及正式環境。
      // 不同環境可以透過pm2 start時以--env production傳入。
      env_production: {
        NODE_ENV: &#39;production&#39;,
      },
      env_development: {
        NODE_ENV: &#39;development&#39;,
      },
      // 當網站實體佔用超過多少記憶體時便重啟
      max_memory_restart: &#39;3.75G&#39;,
    },
  ],
}
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#79B8FF">module</span><span style="--shiki-default:#E1E4E8">.</span><span style="--shiki-default:#79B8FF">exports</span><span style="--shiki-default:#F97583"> =</span><span style="--shiki-default:#E1E4E8"> {
</span></span><span class="line" line="2"><span style="--shiki-default:#E1E4E8">  apps: [
</span></span><span class="line" line="3"><span style="--shiki-default:#E1E4E8">    {
</span></span><span class="line" line="4"><span style="--shiki-default:#6A737D">      // 設定不同環境時的參數，可以區分開發、測試以及正式環境。
</span></span><span class="line" line="5"><span style="--shiki-default:#6A737D">      // 不同環境可以透過pm2 start時以--env production傳入。
</span></span><span class="line" line="6"><span style="--shiki-default:#E1E4E8">      env_production: {
</span></span><span class="line" line="7"><span style="--shiki-default:#E1E4E8">        NODE_ENV: </span><span style="--shiki-default:#9ECBFF">&#39;production&#39;</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="8"><span style="--shiki-default:#E1E4E8">      },
</span></span><span class="line" line="9"><span style="--shiki-default:#E1E4E8">      env_development: {
</span></span><span class="line" line="10"><span style="--shiki-default:#E1E4E8">        NODE_ENV: </span><span style="--shiki-default:#9ECBFF">&#39;development&#39;</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="11"><span style="--shiki-default:#E1E4E8">      },
</span></span><span class="line" line="12"><span style="--shiki-default:#6A737D">      // 當網站實體佔用超過多少記憶體時便重啟
</span></span><span class="line" line="13"><span style="--shiki-default:#E1E4E8">      max_memory_restart: </span><span style="--shiki-default:#9ECBFF">&#39;3.75G&#39;</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="14"><span style="--shiki-default:#E1E4E8">    },
</span></span><span class="line" line="15"><span style="--shiki-default:#E1E4E8">  ],
</span></span><span class="line" line="16"><span style="--shiki-default:#E1E4E8">}
</span></span></code><!--]--></pre></div></div><hr><h2 id="設定開機時自動重新啟動-pm2"><!--[-->設定開機時自動重新啟動 pm2<!--]--></h2><p><!--[-->若網站是部署在主機上，而非透過容器方式的話，設定主機重開機時自動重新啟動後，可以防止主機意外重新啟動後網站掛掉的問題。先輸入下列指令：<!--]--></p><div class="position-relative language-bash shiki shiki-themes github-dark" code="pm2 startup
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#B392F0">pm2</span><span style="--shiki-default:#9ECBFF"> startup
</span></span></code><!--]--></pre></div></div><p><!--[-->接著終端機會出現像這樣的提示，要你複製一段指令並執行：<!--]--></p><div class="position-relative language-bash shiki shiki-themes github-dark" code="[PM2] Init System found: systemd
[PM2] To setup the Startup Script, copy/paste the following command:
sudo env PATH=$PATH:/home/somuser/.nvm/versions/node/v20.14.0/bin /home/someuser/.nvm/versions/node/v20.14.0/lib/node_modules/pm2/bin/pm2 startup &lt;distribution&gt; -u &lt;user&gt; --hp &lt;home-path&gt;
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E1E4E8">[PM2] Init System found: systemd
</span></span><span class="line" line="2"><span style="--shiki-default:#E1E4E8">[PM2] To setup the Startup Script, copy/paste the following command:
</span></span><span class="line" line="3"><span style="--shiki-default:#B392F0">sudo</span><span style="--shiki-default:#9ECBFF"> env</span><span style="--shiki-default:#9ECBFF"> PATH=</span><span style="--shiki-default:#E1E4E8">$PATH</span><span style="--shiki-default:#9ECBFF">:/home/somuser/.nvm/versions/node/v20.14.0/bin</span><span style="--shiki-default:#9ECBFF"> /home/someuser/.nvm/versions/node/v20.14.0/lib/node_modules/pm2/bin/pm2</span><span style="--shiki-default:#9ECBFF"> startup</span><span style="--shiki-default:#F97583"> &lt;</span><span style="--shiki-default:#9ECBFF">distributio</span><span style="--shiki-default:#E1E4E8">n</span><span style="--shiki-default:#F97583">&gt;</span><span style="--shiki-default:#79B8FF"> -u</span><span style="--shiki-default:#F97583"> &lt;</span><span style="--shiki-default:#9ECBFF">use</span><span style="--shiki-default:#E1E4E8">r</span><span style="--shiki-default:#F97583">&gt;</span><span style="--shiki-default:#79B8FF"> --hp</span><span style="--shiki-default:#F97583"> &lt;</span><span style="--shiki-default:#9ECBFF">home-pat</span><span style="--shiki-default:#E1E4E8">h</span><span style="--shiki-default:#F97583">&gt;
</span></span></code><!--]--></pre></div></div><p><!--[-->指令的內容會根據你目前所在的系統版本、使用的 nodejs 環境而有所不同，總之就複製後執行。最後透過 pm2 執行所有你在重開機時想要自動執行的網站後，再執行下列指令：<!--]--></p><div class="position-relative language-bash shiki shiki-themes github-dark" code="pm2 save
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#B392F0">pm2</span><span style="--shiki-default:#9ECBFF"> save
</span></span></code><!--]--></pre></div></div><p><!--[-->這樣就設定完成了。<!--]--></p><h3 id="取消自動重新啟動"><!--[-->取消自動重新啟動<!--]--></h3><p><!--[-->若想要取消自動重新啟動的話，可以透過下列指令：<!--]--></p><div class="position-relative language-bash shiki shiki-themes github-dark" code="pm2 unstartup
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#B392F0">pm2</span><span style="--shiki-default:#9ECBFF"> unstartup
</span></span></code><!--]--></pre></div></div><p><!--[--><strong><!--[-->在主機 node 環境有升級的時候，要記得先<code class=""><!--[-->unstartup<!--]--></code>，再重新設定。<!--]--></strong><!--]--></p><style>html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div></article><!--]--></div><hr class="d-md-none d-block"><a href="https://ko-fi.com/chaoschaoshuang" target="_blank" rel="noopener noreferrer " class="mt-5 d-flex justify-content-center"><!--[--><img src="/blog/images/donation/kofi_button_blue.png" alt="Support me on Ko-fi" class="img-fluid d-block" width="200"><!--]--></a><div class="giscus mt-5"></div><div class="d-flex flex-column mt-5"><h5 class="mb-0"><div class="d-inline-block">相關文章 <div class="w-50 border-bottom border-primary border-2 mt-2"></div></div></h5><div class="mt-4 flex-grow-1"><!--[--><!--[--><a href="/blog/nuxt2_bootstrapvue_treeshaking/" class="_card_9thhq_2 _container_9thhq_2 bg-foreground text-decoration-none rounded d-flex flex-column flex-lg-row p-3 p-lg-4 mb-3"><!--[--><picture class="_img_1ygqe_2 me-lg-3 rounded"><!--[--><!--]--><img class="_img_5u372_2 rounded _img_1ygqe_2" src="https://imagizer.imageshack.com/v2/640x480q70/924/Oqxy2g.jpg" loading="lazy"></picture><div class="d-flex flex-column flex-grow-1"><h4 class="_title_1nrvw_2 text-line-2 mt-2 pt-1 pt-lg-0 mt-lg-0 mb-2 mb-lg-3"><!--[-->Nuxt2中的BootstrapVue TreeShaking<!--]--></h4><p class="text-muted text-line-2 _description_3l36l_2 mb-0" title="Bootstrap 是個很好用的 UI 框架，在 Vue 生態系中主要由 Bootstrap Vue 去作銜接，然而在專案中幾乎不會完全使用到 Bootstrap 的所有功能，這時如果把不必要的 css / js 編譯移除，可以降低編譯後專案的大小，這種行為也被稱為 Tree shaking。本篇紀錄了自己在 Nuxt2 中使用 Bootstrap Vue 時，Tree Shaking 的一些步驟。">Bootstrap 是個很好用的 UI 框架，在 Vue 生態系中主要由 Bootstrap Vue 去作銜接，然而在專案中幾乎不會完全使用到 Bootstrap 的所有功能，這時如果把不必要的 css / js 編譯移除，可以降低編譯後專案的大小，這種行為也被稱為 Tree shaking。本篇紀錄了自己在 Nuxt2 中使用 Bootstrap Vue 時，Tree Shaking 的一些步驟。</p><div class="d-flex flex-row flex-grow-1 align-items-end mt-2 mt-lg-0"><time class="d-flex align-items-center flex-row text-muted small mb-0 flex-grow-1"><!--[--><i class="bi-pencil-square me-1"></i><span>2023/12/11</span><!--]--></time><span class="text-muted small d-inline-flex align-items-center"><i class="bi-clock me-1"></i><span>4 min</span></span></div></div><!--]--></a><a href="/blog/nuxt2_content_git/" class="_card_9thhq_2 _container_9thhq_2 bg-foreground text-decoration-none rounded d-flex flex-column flex-lg-row p-3 p-lg-4 mb-3"><!--[--><picture class="_img_1ygqe_2 me-lg-3 rounded"><!--[--><!--]--><img class="_img_5u372_2 rounded _img_1ygqe_2" src="https://imagizer.imageshack.com/v2/640x480q70/924/WCeWkF.jpg" loading="lazy"></picture><div class="d-flex flex-column flex-grow-1"><h4 class="_title_1nrvw_2 text-line-2 mt-2 pt-1 pt-lg-0 mt-lg-0 mb-2 mb-lg-3"><!--[-->使用nuxt-content-git取得Nuxt2 Content中正確的檔案時間<!--]--></h4><p class="text-muted text-line-2 _description_3l36l_2 mb-0" title="建完這個部落格之後，發現好像不太對，怎麼前幾天發的文章，日期卻變成今天。後來發現是因為若從 A 電腦更新文章，在 B 電腦用 git 同步更新檔案之後，檔案的更新日期會變成當下的時間。">建完這個部落格之後，發現好像不太對，怎麼前幾天發的文章，日期卻變成今天。後來發現是因為若從 A 電腦更新文章，在 B 電腦用 git 同步更新檔案之後，檔案的更新日期會變成當下的時間。</p><div class="d-flex flex-row flex-grow-1 align-items-end mt-2 mt-lg-0"><time class="d-flex align-items-center flex-row text-muted small mb-0 flex-grow-1"><!--[--><i class="bi-pencil-square me-1"></i><span>2023/10/30</span><!--]--></time><span class="text-muted small d-inline-flex align-items-center"><i class="bi-clock me-1"></i><span>2 min</span></span></div></div><!--]--></a><a href="/blog/nuxt2_dynamic_routes_sitemap/" class="_card_9thhq_2 _container_9thhq_2 bg-foreground text-decoration-none rounded d-flex flex-column flex-lg-row p-3 p-lg-4 mb-3"><!--[--><picture class="_img_1ygqe_2 me-lg-3 rounded"><!--[--><!--]--><img class="_img_5u372_2 rounded _img_1ygqe_2" src="https://imagizer.imageshack.com/v2/640x480q70/923/KaAGJw.png" loading="lazy"></picture><div class="d-flex flex-column flex-grow-1"><h4 class="_title_1nrvw_2 text-line-2 mt-2 pt-1 pt-lg-0 mt-lg-0 mb-2 mb-lg-3"><!--[-->在Nuxt 2中建立動態routes的sitemap<!--]--></h4><p class="text-muted text-line-2 _description_3l36l_2 mb-0" title="Sitemap 雖然對網站來說非必要，但為了 SEO 考量通常都還是會建立。而在 Nuxt 2 中可以透過@nuxt/sitemap模組來簡單建立 sitemap。但若遇到動態頁面，這個模組無法自動新增，官方文件要求使用者必須自行新增，而官方建議的作法以及網路上查到的方式好像都滿麻煩的，所以自己搞了一個小撇步出來，覺得頗方便，所以就紀錄下來。">Sitemap 雖然對網站來說非必要，但為了 SEO 考量通常都還是會建立。而在 Nuxt 2 中可以透過@nuxt/sitemap模組來簡單建立 sitemap。但若遇到動態頁面，這個模組無法自動新增，官方文件要求使用者必須自行新增，而官方建議的作法以及網路上查到的方式好像都滿麻煩的，所以自己搞了一個小撇步出來，覺得頗方便，所以就紀錄下來。</p><div class="d-flex flex-row flex-grow-1 align-items-end mt-2 mt-lg-0"><time class="d-flex align-items-center flex-row text-muted small mb-0 flex-grow-1"><!--[--><i class="bi-calendar-event me-1"></i><span>2023/10/30</span><!--]--></time><span class="text-muted small d-inline-flex align-items-center"><i class="bi-clock me-1"></i><span>4 min</span></span></div></div><!--]--></a><!--]--><!--]--></div></div><!--]--></div><!--]--><!--]--></main></div><footer class="pb-3 pb-lg-5 _footer_4zxf0_2 mt-4"><div class="container-md text-white"><!--[--><div class="row"><!--[--><div class="col-md-4 col-12 mt-3 mt-lg-5"><!--[--><div class="fw-bold mb-2 d-flex align-items-center h6 text-primary"><!--[--><a href="/blog/buy_me_a_tea#%E9%97%9C%E6%96%BC%E6%88%91" class="text-primary">關於我</a><!--[--><img src="/blog/pwa-64x64.png" height="16" width="16" class="common-icon rounded-circle shadow-sm ms-2"><!--]--><!--]--></div><div class="small"><!--[--><!--[--> 工作時若不喝上一杯飲料就無法做事的前端小碼農。三大前端框架陣營中屬於 Vue 陣營。 <!--]--><!--]--></div><!--]--></div><div class="col-md-4 col-12 mt-3 mt-lg-5"><!--[--><div class="fw-bold mb-2 d-flex align-items-center h6 text-primary"><!--[--><a href="/blog/buy_me_a_tea#%E9%97%9C%E6%96%BC%E9%9A%A8%E6%A9%9F%E6%89%8B%E6%9C%AD" class="text-primary">關於隨機手札</a><!--[--><!--]--><!--]--></div><div class="small"><!--[--><!--[--> 使用 <a href="https://v2.nuxt.com/" target="_blank" rel="noopener noreferrer " class="text-white"><!--[--><!--[--> Nuxt 2 <!--]--><!--]--></a> 建置於 <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer " class="text-white"><!--[--><!--[--> Github Pages <!--]--><!--]--></a> 上，全站文字皆在 <a href="https://creativecommons.org/licenses/by-nd/4.0/legalcode.zh-hant" target="_blank" rel="noopener noreferrer " class="text-white"><!--[--><!--[--> 創用CC BY-ND 4.0 條款 <!--]--><!--]--></a> 下提供。 <!--]--><!--]--></div><!--]--></div><div class="col-md-4 col-12 mt-3 mt-lg-5"><!--[--><div class="fw-bold mb-2 d-flex align-items-center h6 text-primary"><!--[--><a href="/blog/buy_me_a_tea#%E8%AB%8B%E6%88%91%E5%96%9D%E6%9D%AF%E6%89%8B%E6%90%96%E9%A3%B2%E5%90%A7%EF%BC%81" class="text-primary">請我喝杯手搖飲吧！</a><!--[--><!--]--><!--]--></div><div class="small"><!--[--><!--[--> 若這裡的經驗分享有幫助到你，可以透過<a href="https://ko-fi.com/chaoschaoshuang" target="_blank" rel="noopener noreferrer " class="text-white"><!--[--><!--[--> Ko-fi <!--]--><!--]--></a>請我喝杯手搖飲哦！ <!--]--><!--]--></div><!--]--></div><!--]--></div><!--]--></div></footer><!--]--><span></span><!--]--></div><div id="teleports"></div><script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/blog/vue_stack_deployment_pm2/_payload.json?84f3c8ff-4e09-4330-9879-b8a7aebb6bd3">[{"state":1,"once":7,"_errors":8,"serverRendered":11,"path":12,"pinia":13,"prerenderedAt":54},["Reactive",2],{"$ssite-config":3},{"env":4,"name":5,"url":6},"production","blog","https://huangchingchieh.github.io",["Set"],["ShallowReactive",9],{"vue_stack_deployment_pm2":10,"Related_vue_stack_deployment_pm2":10},null,true,"/vue_stack_deployment_pm2/",["Reactive",14],{"main":15,"theme":53},{"tagsObj":16,"categories":26,"articlesMetadata":35,"toc":36},{"部落格":17,"關於我":18,"贊助":18,"罐頭":18,"飲食":18,"portfolio":18,"collections":18,"defi":19,"冷錢包":18,"加密貨幣":19,"ftx":18,"投資":17,"流動性挖礦":17,"fedora":20,"intel turbo boost":18,"docker":19,"android":21,"custom rom":19,"gooel pixel 3a":19,"lineageos":19,"mega":18,"megasync":18,"雲端硬碟":18,"rar":18,"unrar":18,"youtube":18,"zram":18,"自由潛水":18,"潛水":18,"linux":18,"windows":17,"macbook air":18,"apple":18,"舊筆電復活":17,"德國男歌手":18,"音樂":18,"css":18,"html":18,"chrome":18,"vue":20,"nuxt":22,"bootstrap":17,"nuxt2":23,"nuxt content v1":18,"nuxt content":17,"markdown":18,"sitemap":17,"沖繩":24,"自助旅行":24,"自由行":24,"okinawa":24,"首里城":18,"單軌列車":17,"沖繩蕎麥麵":18,"敘敘院燒肉":18,"a&w":18,"豬肉蛋飯糰":18,"貢茶":18,"吉野家":18,"琉球新麵通堂":18,"blue seal":18,"波上宮":18,"沖繩縣立博物館・美術館":18,"住宿":18,"東急":18,"tokyu stay":18,"觀光巴士":17,"萬座毛":18,"古宇利島":18,"美麗海水族館":18,"美國村":18,"知念岬":18,"玉泉洞":18,"王國村":18,"沖繩世界":18,"糸満漁市場":18,"ashibinaa":18,"outlet":18,"瀨長島":18,"額外收入":18,"問卷調查":18,"ubuntu":17,"swap":18,"社會議題":17,"lgbt":17,"翻譯":17,"usb":18,"安裝":18,"重灌":18,"chromeos flex":18,"chromeos":18,"asus":18,"asus e203na":18,"medium":18,"blogger":18,"matters":18,"github pages":18,"podman":18,"vscode":17,"devcontainer":17,"blog":25,"nuxt3":23,"bootstrapvue":18,"bootstrap 4":18,"bootstrap 5":18,"pwa":17,"vuex":18,"pinia":18,"vite-pwa":18,"pm2":18},2,1,3,12,4,13,8,6,7,{"life":27,"frontend":29,"linux":30,"all":32},{"count":28,"pageCount":17},17,{"count":28,"pageCount":17},{"count":31,"pageCount":17},15,{"count":33,"pageCount":34},49,5,{"count":33,"pageCount":34},[37,40,42,47],{"id":38,"depth":17,"text":39},"什麼是-pm2","什麼是 PM2",{"id":41,"depth":17,"text":41},"安裝",{"id":43,"depth":17,"text":43,"children":44},"設定與執行",[45],{"id":46,"depth":19,"text":46},"自己常用的其他設定",{"id":48,"depth":17,"text":49,"children":50},"設定開機時自動重新啟動-pm2","設定開機時自動重新啟動 pm2",[51],{"id":52,"depth":19,"text":52},"取消自動重新啟動",{"dark":10,"preferDark":11},1733124055397]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{base:"/blog/",imageServer:"https://imagizer.imageshack.com/v2/",appHost:"https://huangchingchieh.github.io/blog/",perPage:10,categoriesMap:{all:"最新文章",linux:"Linux心得",frontend:"前端筆記",life:"生活雜記"},description:"一個非本科系的前端小碼農，紀錄一些身為前端小碼農的技術筆記、使用Linux（主要是Fedora）的心得，以及生活上雜七雜八的事情。",isDev:false,mdc:{components:{prose:true,map:{p:"prose-p",a:"ArticleOuterLink",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr",pre:"ArticleCode"}},headings:{anchorLinks:{h1:false,h2:false,h3:false,h4:false,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1733123972539,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:[]},tags:{p:"prose-p",a:"ArticleOuterLink",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr",pre:"ArticleCode"},highlight:{theme:"github-dark",highlighter:"shiki",shikiEngine:"oniguruma",langs:["js","jsx","json","ts","tsx","vue","css","html","bash","md","mdc","yaml"]},wsUrl:"",documentDriven:false,host:"",trailingSlash:false,search:{indexed:true,ignoredTags:["script","style","pre"],filterQuery:{_draft:false,_partial:false},options:{fields:["title","content","titles"],storeFields:["title","content","titles"],searchOptions:{prefix:true,fuzzy:.2,boost:{title:4,content:2,titles:1}}}},contentHead:true,anchorLinks:false}},app:{baseURL:"/blog/",buildId:"84f3c8ff-4e09-4330-9879-b8a7aebb6bd3",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>