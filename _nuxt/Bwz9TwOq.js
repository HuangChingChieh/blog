import{_ as q}from"./BA7AsFk-.js";import{o as l,c as g,w as h,a as d,_ as J,b as $,t as w,u as p,g as F,d as A,e as V,f as x,h as y,r as M,i as L,n as f,j as z,k as Q,F as H,l as N,A as G,m as v,p as U,q as S,s as B,v as W,x as K,y as O,z as I,B as Y,C as X,D as Z,E,G as ee,H as te,I as se,J as ne}from"./Jd92928_.js";import ae from"./CQ20jJNJ.js";import{A as oe,_ as re}from"./hd22tNIj.js";import{_ as ce}from"./Big9qxoG.js";import{u as ie}from"./DWAUYwb1.js";import"./Fm6CRRX5.js";import"./C-v3KzvZ.js";import"./CxYJgpPD.js";const le={__name:"article-category",props:{article:{type:Object,default:()=>({})}},setup(e){return(t,s)=>{const n=V;return e.article&&e.article.category?(l(),g(n,{key:0,to:p(F)({category:e.article.category}),class:"text-muted small d-inline-flex align-items-center"},{default:h(()=>[d(J,{icon:"folder",class:"me-1"}),$("span",null,w(t.$config.public.categoriesMap[e.article.category]),1)]),_:1},8,["to"])):A("",!0)}}},ue={},me={class:"badge bg-secondary text-bg-secondary"};function de(e,t){return l(),y("span",me,[M(e.$slots,"default")])}const pe=x(ue,[["render",de]]),ge={__name:"article-tag",props:{tagName:{type:String,default:""}},setup(e){return(t,s)=>(l(),g(pe,{class:"d-inline-block fw-normal font-monospace"},{default:h(()=>[s[0]||(s[0]=L(" #")),M(t.$slots,"default",{},()=>[L(w(e.tagName),1)])]),_:3}))}},_e="_article_13jpp_2",fe="_title_13jpp_5",ye="_date_13jpp_11",he="_tags_13jpp_14",be="_banner_13jpp_17",$e={article:_e,title:fe,date:ye,tags:he,banner:be,"article-img":"_article-img_13jpp_18"},ke={class:"d-flex flex-row align-items-center my-2"},Ce={__name:"common-article",props:{document:{type:Object,default:()=>({})}},setup(e){return(t,s)=>{const n=ae;return l(),y("article",{class:f(t.$style.article)},[$("h1",{class:f(t.$style.title)},w(e.document.title),3),$("div",ke,[d(z,{document:e.document,class:f([t.$style.date,"me-3"])},null,8,["document","class"]),d(Q,{minutes:e.document.readingTime.minutes,class:"me-3"},null,8,["minutes"]),d(le,{article:e.document},null,8,["article"])]),e.document.tags?(l(),y("div",{key:0,class:f(["d-flex flex-wrap my-2",t.$style.tags])},[(l(!0),y(H,null,N(e.document.tags,r=>(l(),g(ge,{key:r,"tag-name":r,class:"me-1 mb-1"},null,8,["tag-name"]))),128))],2)):A("",!0),e.document.img?(l(),g(G,{key:1,img:e.document.img,"img-class":"rounded",class:f(["rounded",t.$style.banner]),preload:""},null,8,["img","class"])):A("",!0),d(n,{value:e.document,class:"nuxt-content"},null,8,["value"])],2)}}},Ae={$style:$e},ve=x(Ce,[["__cssModules",Ae]]),we="_grid_raqec_2",xe="_card_raqec_24",je={grid:we,card:xe},Le={__name:"articles-related",props:{articles:{type:Array,default:()=>[]}},setup(e){const t=e,s=v(()=>{const{articles:n}=t;return Array.isArray(n)&&n.length>0});return(n,r)=>{const m=oe,a=re;return p(s)?(l(),g(a,{key:0,title:"相關文章"},{default:h(()=>[(l(!0),y(H,null,N(e.articles,(u,o)=>(l(),g(m,{key:o,article:u,class:"mb-3"},null,8,["article"]))),128))]),_:1})):A("",!0)}}},Se={$style:je},Ee=x(Le,[["__cssModules",Se]]),Me=["src"],He={__name:"liker-button",setup(e){return(t,s)=>(l(),g(ce,{href:"https://ko-fi.com/chaoschaoshuang"},{default:h(()=>[$("img",{src:`${t.$config.public.base}images/donation/kofi_button_blue.png`,alt:"Support me on Ko-fi",class:"img-fluid d-block",width:"200"},null,8,Me)]),_:1}))}},Ne=new RegExp("\\p{Lu}?\\p{Ll}+|[0-9]+|\\p{Lu}+(?!\\p{Ll})|\\p{Emoji_Presentation}|\\p{Extended_Pictographic}|\\p{L}+","gu");function Be(e){return Array.from(e.match(Ne)??[])}function Oe(e){return Be(e).map(s=>s.toLowerCase()).join("-")}let b=null;const Ie={mounted(e,{value:t,arg:s}){typeof t=="function"&&(b=new IntersectionObserver(n=>{t(n[0].intersectionRatio>0)},{rootMargin:s||"0px"}),b.observe(e))},beforeUnmount(){b&&b instanceof IntersectionObserver&&b.disconnect()}},Pe={__name:"article-comment",setup(e){const t=U(),s=v(()=>t.darkComputed?"dark":"light"),n={repo:"HuangChingChieh/blog",repoId:"R_kgDOHHJsJQ",category:"Announcements",categoryId:"DIC_kwDOHHJsJc4CcL42",reactionsEnabled:0,emitMetadata:0,inputPosition:"top",lang:"zh-TW",loading:"lazy",theme:s.value},r=S(!1),m=S(null),a=v(()=>{const o=[];if(r.value){const c={src:"https://giscus.app/client.js",crossorigin:"anonymous"};Object.keys(n).forEach(i=>{c[`data-${Oe(i)}`]=n[i]}),o.push(c)}return o});B({script:a}),W(s,()=>{const o=m.value.querySelector("iframe.giscus-frame");o&&o instanceof HTMLIFrameElement&&o.contentWindow.postMessage({giscus:{setConfig:{theme:s.value}}},"https://giscus.app")});const u=o=>{o&&!r.value&&(r.value=!0)};return(o,c)=>K((l(),y("div",{ref_key:"comments",ref:m,class:"giscus"},null,512)),[[p(Ie),u]])}},Re=({description:e="",title:t="",img:s="",url:n="",tags:r=[],createdAt:m="",updatedAt:a=""})=>{const u=[{key:"description",name:"description",content:e},{key:"og:url",property:"og:url",content:n},{key:"og:type",property:"og:type",content:"article"},{key:"og:title",property:"og:title",content:t},{key:"og:description",property:"og:description",content:e},{key:"og:image",property:"og:image",content:s},{key:"og:article:published_time",property:"og:article:published_time",content:m},{key:"og:article:modified_time",property:"og:article:modified_time",content:a}];return r.forEach(o=>{u.push({property:"og:article:tag",content:o})}),{title:t,meta:u,script:[{hid:"article-json-ld",type:"application/ld+json",innerHTML:JSON.stringify({"@context":"https://schema.org","@type":"BlogPosting",headline:t,image:[s],datePublished:m,dateModified:a,author:[{"@type":"Person",name:"HuangChingChieh",url:"https://huangchingchieh.github.io/"}]})}]}},Te=e=>{if(!e)throw new Error("Need slug to find article!");return O(e,()=>I("articles").where({slug:e}).findOne(),"$SpfYyUQ7eF")},De=async(e={tags:[],slug:""})=>O(`Related_${e.slug}`,async()=>{const t=await I("articles").only([...Y.card,"tags"]).sort({createdAt:-1}).find(),s=[],n={},r=e.tags,m=e.slug;if(!Array.isArray(r)||r.length===0)return s;t.forEach(u=>{const{tags:o,slug:c}=u;if(!Array.isArray(o)||m===c)return;const i=o.reduce((_,k)=>_+r.some(C=>typeof k=="string"&&typeof C=="string"&&k.toLowerCase()===C.toLowerCase()),0);i!==0&&(n[i]||(n[i]=[]),n[i].push(u))});const a=Object.keys(n);if(a.length>0){a.sort((c,i)=>i-c);const u=3;let o=0;for(;o<a.length&&s.length<u;){const c=n[a[o]];c.length>0?s.push(c.pop()):o++}}return s}),Ke={__name:"[slug]",async setup(e){let t,s;const n=ie();X((c,i,_)=>{n.toc=[],_()});const r=Z(),{slug:m}=r.params,{data:a}=([t,s]=E(()=>Te(m)),t=await t,s(),t);a!=null&&a.value?n.toc=a.value.body.toc.links:ee()({statusCode:"404"});const{data:u}=([t,s]=E(()=>De(p(a))),t=await t,s(),t),o=v(()=>{let c=[];if(a!=null&&a.value){const{appHost:i,imageServer:_}=ne().public,{title:k,description:C,img:j,tags:P,updatedAt:R,createdAt:T}=a.value,D=i+r.fullPath.substring(1);c=Re({description:C,url:D,title:k,img:j?`${_}1600x1200q100/${j}`:`${i}images/default-og.png`,tags:P,updatedAt:R,createdAt:T})}return c});return B(o.value),(c,i)=>{const _=q;return l(),g(_,{cols:"12",lg:"10",xl:"8",class:"mx-auto"},{default:h(()=>[d(te,null,{default:h(()=>[d(ve,{document:p(a)},null,8,["document"])]),_:1}),$("hr",{class:f(["d-block",`d-${p(se)}-none`])},null,2),d(He,{class:"mt-5 d-flex justify-content-center"}),d(Pe,{class:"mt-5"}),d(Ee,{article:p(a),class:"mt-5",articles:p(u)},null,8,["article","articles"])]),_:1})}}};export{Ke as default};
