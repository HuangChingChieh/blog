import{_ as w,o as m,c as y,r as M,a as p,w as h,b as L,t as x,d,e as J,f as C,u as g,g as F,h as A,i as V,n as f,j as z,k as Q,F as H,l as O,m as v,p as G,q as U,s as S,v as B,x as W,y as K,z as N,A as P,B as T,C as Y,D as X,E,G as Z,H as ee,I as te,J as se}from"./DbvD-16J.js";import{C as ne}from"./DZGRdKvs.js";import ae from"./BSx16UrT.js";import{A as oe}from"./BO74igD-.js";import{_ as re}from"./lsoeOQF0.js";import{_ as ce}from"./BTC36bp3.js";import{u as ie,a as le}from"./BwKRuaDg.js";import"./C3yXf26C.js";import"./C-v3KzvZ.js";import"./CxYJgpPD.js";const ue=new RegExp("\\p{Lu}?\\p{Ll}+|[0-9]+|\\p{Lu}+(?!\\p{Ll})|\\p{Emoji_Presentation}|\\p{Extended_Pictographic}|\\p{L}+","gu");function me(e){return Array.from(e.match(ue)??[])}function de(e){return me(e).map(s=>s.toLowerCase()).join("-")}const ge={},pe={class:"badge bg-secondary text-bg-secondary"};function _e(e,t){return m(),y("span",pe,[M(e.$slots,"default")])}const fe=w(ge,[["render",_e]]),ye={__name:"article-tag",props:{tagName:{type:String,default:""}},setup(e){return(t,s)=>(m(),p(fe,{class:"d-inline-block fw-normal font-monospace"},{default:h(()=>[s[0]||(s[0]=L(" #")),M(t.$slots,"default",{},()=>[L(x(e.tagName),1)])]),_:3}))}},he={__name:"article-category",props:{article:{type:Object,default:()=>({})}},setup(e){return(t,s)=>{const n=V;return e.article&&e.article.category?(m(),p(n,{key:0,to:g(F)({category:e.article.category}),class:"text-muted small d-inline-flex align-items-center"},{default:h(()=>[d(J,{icon:"folder",class:"me-1"}),C("span",null,x(t.$config.public.categoriesMap[e.article.category]),1)]),_:1},8,["to"])):A("",!0)}}},be="_article_13jpp_2",Ce="_title_13jpp_5",$e="_date_13jpp_11",ke="_tags_13jpp_14",Ae="_banner_13jpp_17",ve={article:be,title:Ce,date:$e,tags:ke,banner:Ae,"article-img":"_article-img_13jpp_18"},we={class:"d-flex flex-row align-items-center my-2"},xe={__name:"common-article",props:{document:{type:Object,default:()=>({})}},setup(e){return(t,s)=>{const n=ae;return m(),y("article",{class:f(t.$style.article)},[C("h1",{class:f(t.$style.title)},x(e.document.title),3),C("div",we,[d(z,{document:e.document,class:f([t.$style.date,"me-3"])},null,8,["document","class"]),d(Q,{minutes:e.document.readingTime.minutes,class:"me-3"},null,8,["minutes"]),d(he,{article:e.document},null,8,["article"])]),e.document.tags?(m(),y("div",{key:0,class:f(["d-flex flex-wrap my-2",t.$style.tags])},[(m(!0),y(H,null,O(e.document.tags,r=>(m(),p(ye,{key:r,"tag-name":r,class:"me-1 mb-1"},null,8,["tag-name"]))),128))],2)):A("",!0),e.document.img?(m(),p(oe,{key:1,img:e.document.img,"img-class":"rounded",class:f(["rounded",t.$style.banner]),preload:""},null,8,["img","class"])):A("",!0),d(n,{value:e.document,class:"nuxt-content"},null,8,["value"])],2)}}},je={$style:ve},Le=w(xe,[["__cssModules",je]]),Se="_grid_raqec_2",Ee="_card_raqec_24",Me={grid:Se,card:Ee},He={__name:"articles-related",props:{articles:{type:Array,default:()=>[]}},setup(e){const t=e,s=v(()=>{const{articles:n}=t;return Array.isArray(n)&&n.length>0});return(n,r)=>{const l=G,a=re;return g(s)?(m(),p(a,{key:0,title:"相關文章"},{default:h(()=>[(m(!0),y(H,null,O(e.articles,(i,o)=>(m(),p(l,{key:o,article:i,class:"mb-3"},null,8,["article"]))),128))]),_:1})):A("",!0)}}},Oe={$style:Me},Be=w(He,[["__cssModules",Oe]]),Ne=["src"],Pe={__name:"liker-button",setup(e){return(t,s)=>(m(),p(ce,{href:"https://ko-fi.com/chaoschaoshuang"},{default:h(()=>[C("img",{src:`${t.$config.public.base}images/donation/kofi_button_blue.png`,alt:"Support me on Ko-fi",class:"img-fluid d-block",width:"200"},null,8,Ne)]),_:1}))}};let b=null;const Te={mounted(e,{value:t,arg:s}){typeof t=="function"&&(b=new IntersectionObserver(n=>{t(n[0].intersectionRatio>0)},{rootMargin:s||"0px"}),b.observe(e))},beforeUnmount(){b&&b instanceof IntersectionObserver&&b.disconnect()}},Ie={__name:"article-comment",setup(e){const t=U(),s=v(()=>t.darkComputed?"dark":"light"),n={repo:"HuangChingChieh/blog",repoId:"R_kgDOHHJsJQ",category:"Announcements",categoryId:"DIC_kwDOHHJsJc4CcL42",reactionsEnabled:0,emitMetadata:0,inputPosition:"top",lang:"zh-TW",loading:"lazy",theme:s.value},r=S(!1),l=S(null),a=v(()=>{const o=[];if(r.value){const c={src:"https://giscus.app/client.js",crossorigin:"anonymous"};Object.keys(n).forEach(u=>{c[`data-${de(u)}`]=n[u]}),o.push(c)}return o});B({script:a}),W(s,()=>{const o=l.value.querySelector("iframe.giscus-frame");o&&o instanceof HTMLIFrameElement&&o.contentWindow.postMessage({giscus:{setConfig:{theme:s.value}}},"https://giscus.app")});const i=o=>{o&&!r.value&&(r.value=!0)};return(o,c)=>K((m(),y("div",{ref_key:"comments",ref:l,class:"giscus"},null,512)),[[g(Te),i]])}},Re=({description:e="",title:t="",img:s="",url:n="",tags:r=[],createdAt:l="",updatedAt:a=""})=>{const i=[{key:"description",name:"description",content:e},{key:"og:url",property:"og:url",content:n},{key:"og:type",property:"og:type",content:"article"},{key:"og:title",property:"og:title",content:t},{key:"og:description",property:"og:description",content:e},{key:"og:image",property:"og:image",content:s},{key:"og:article:published_time",property:"og:article:published_time",content:l},{key:"og:article:modified_time",property:"og:article:modified_time",content:a}];return r.forEach(o=>{i.push({property:"og:article:tag",content:o})}),{title:t,meta:i,script:[{hid:"article-json-ld",type:"application/ld+json",innerHTML:JSON.stringify({"@context":"https://schema.org","@type":"BlogPosting",headline:t,image:[s],datePublished:l,dateModified:a,author:[{"@type":"Person",name:"HuangChingChieh",url:"https://huangchingchieh.github.io/"}]})}]}},De=async e=>{if(!e)throw new Error("Need slug to find article!");return N(e,async()=>{const t=["body","category","createdAt","img","readingTime","slug","title","updatedAt","tags","description"],s=T.card,n=ie(e),r=P("articles").only(t.filter(i=>!s.some(o=>o===i))).where({slug:e}).findOne(),[l,a]=await Promise.all([n,r]);return Object.assign(l,a),l},"$SpfYyUQ7eF")},qe=async(e={tags:[],slug:""})=>N(`Related_${e.slug}`,async()=>{const t=await P("articles").only([...T.card,"tags"]).sort({createdAt:-1}).find(),s=[],n={},r=e.tags,l=e.slug;if(!Array.isArray(r)||r.length===0)return s;t.forEach(i=>{const{tags:o,slug:c}=i;if(!Array.isArray(o)||l===c)return;const u=o.reduce((_,$)=>_+r.some(k=>typeof $=="string"&&typeof k=="string"&&$.toLowerCase()===k.toLowerCase()),0);u!==0&&(n[u]||(n[u]=[]),n[u].push(i))});const a=Object.keys(n);if(a.length>0){a.sort((c,u)=>u-c);const i=3;let o=0;for(;o<a.length&&s.length<i;){const c=n[a[o]];c.length>0?s.push(c.pop()):o++}}return s}),Xe={__name:"[slug]",async setup(e){let t,s;const n=le();Y((c,u,_)=>{n.toc=[],_()});const r=X(),{slug:l}=r.params,{data:a}=([t,s]=E(()=>De(l)),t=await t,s(),t);a!=null&&a.value?n.toc=a.value.body.toc.links:Z()({statusCode:"404"});const{data:i}=([t,s]=E(()=>qe(g(a))),t=await t,s(),t),o=v(()=>{let c=[];if(a!=null&&a.value){const{appHost:u,imageServer:_}=te().public,{title:$,description:k,img:j,tags:I,updatedAt:R,createdAt:D}=a.value,q=u+r.fullPath.substring(1);c=Re({description:k,url:q,title:$,img:j?`${_}1600x1200q100/${j}`:`${u}images/default-og.png`,tags:I,updatedAt:R,createdAt:D})}return c});return B(o.value),(c,u)=>{const _=se;return m(),p(_,{cols:"12",lg:"10",xl:"8",class:"mx-auto"},{default:h(()=>[d(ne,null,{default:h(()=>[d(Le,{document:g(a)},null,8,["document"])]),_:1}),C("hr",{class:f(["d-block",`d-${g(ee)}-none`])},null,2),d(Pe,{class:"mt-5 d-flex justify-content-center"}),d(Ie,{class:"mt-5"}),d(Be,{article:g(a),class:"mt-5",articles:g(i)},null,8,["article","articles"])]),_:1})}}};export{Xe as default};
