import{_ as q}from"./K3OsR3jk.js";import{_ as w,o as u,c as h,r as E,a as _,w as b,b as j,t as H,d as C,n as f,e as d,f as F,g as J,h as V,F as M,i as B,j as v,A as z,k as A,u as g,l as Q,m as L,p as N,q as G,s as U,v as O,x as P,y as W,z as K,B as Y,C as S,D as X,E as Z,G as ee,H as te}from"./UTOhsZFE.js";import se from"./1G-S04T1.js";import{A as ne,_ as oe}from"./BDokj-wF.js";import{_ as ae}from"./D8FieXBu.js";import{u as re}from"./BOFQ_MB_.js";import"./DpIxqyvI.js";import"./C-v3KzvZ.js";import"./CxYJgpPD.js";const ce={},ie={class:"badge bg-secondary text-bg-secondary"};function le(e,t){return u(),h("span",ie,[E(e.$slots,"default")])}const ue=w(ce,[["render",le]]),me={__name:"article-tag",props:{tagName:{type:String,default:""}},setup(e){return(t,s)=>(u(),_(ue,{class:"d-inline-block fw-normal font-monospace"},{default:b(()=>[s[0]||(s[0]=j(" #")),E(t.$slots,"default",{},()=>[j(H(e.tagName),1)])]),_:3}))}},de="_article_13jpp_2",pe="_title_13jpp_5",ge="_date_13jpp_11",_e="_tags_13jpp_14",fe="_banner_13jpp_17",he={article:de,title:pe,date:ge,tags:_e,banner:fe,"article-img":"_article-img_13jpp_18"},ye={class:"d-flex flex-row align-items-center my-2"},be={__name:"common-article",props:{document:{type:Object,default:()=>({})}},setup(e){return(t,s)=>{const a=se;return u(),h("article",{class:f(t.$style.article)},[C("h1",{class:f(t.$style.title)},H(e.document.title),3),C("div",ye,[d(F,{document:e.document,class:f([t.$style.date,"me-3"])},null,8,["document","class"]),d(J,{minutes:e.document.readingTime.minutes,class:"me-3"},null,8,["minutes"]),d(V,{article:e.document},null,8,["article"])]),e.document.tags?(u(),h("div",{key:0,class:f(["d-flex flex-wrap my-2",t.$style.tags])},[(u(!0),h(M,null,B(e.document.tags,r=>(u(),_(me,{key:r,"tag-name":r,class:"me-1 mb-1"},null,8,["tag-name"]))),128))],2)):v("",!0),e.document.img?(u(),_(z,{key:1,img:e.document.img,"img-class":"rounded",class:f(["rounded",t.$style.banner]),preload:""},null,8,["img","class"])):v("",!0),d(a,{value:e.document,class:"nuxt-content"},null,8,["value"])],2)}}},$e={$style:he},ke=w(be,[["__cssModules",$e]]),Ce="_grid_raqec_2",Ae="_card_raqec_24",ve={grid:Ce,card:Ae},we={__name:"articles-related",props:{articles:{type:Array,default:()=>[]}},setup(e){const t=e,s=A(()=>{const{articles:a}=t;return Array.isArray(a)&&a.length>0});return(a,r)=>{const m=ne,n=oe;return g(s)?(u(),_(n,{key:0,title:"相關文章"},{default:b(()=>[(u(!0),h(M,null,B(e.articles,(l,o)=>(u(),_(m,{key:o,article:l,class:"mb-3"},null,8,["article"]))),128))]),_:1})):v("",!0)}}},xe={$style:ve},je=w(we,[["__cssModules",xe]]),Le=["src"],Se={__name:"liker-button",setup(e){return(t,s)=>(u(),_(ae,{href:"https://ko-fi.com/chaoschaoshuang"},{default:b(()=>[C("img",{src:`${t.$config.public.base}images/donation/kofi_button_blue.png`,alt:"Support me on Ko-fi",class:"img-fluid d-block",width:"200"},null,8,Le)]),_:1}))}},Ee=new RegExp("\\p{Lu}?\\p{Ll}+|[0-9]+|\\p{Lu}+(?!\\p{Ll})|\\p{Emoji_Presentation}|\\p{Extended_Pictographic}|\\p{L}+","gu");function He(e){return Array.from(e.match(Ee)??[])}function Me(e){return He(e).map(s=>s.toLowerCase()).join("-")}let y=null;const Be={mounted(e,{value:t,arg:s}){typeof t=="function"&&(y=new IntersectionObserver(a=>{t(a[0].intersectionRatio>0)},{rootMargin:s||"0px"}),y.observe(e))},beforeUnmount(){y&&y instanceof IntersectionObserver&&y.disconnect()}},Ne={__name:"article-comment",setup(e){const t=Q(),s=A(()=>t.darkComputed?"dark":"light"),a={repo:"HuangChingChieh/blog",repoId:"R_kgDOHHJsJQ",category:"Announcements",categoryId:"DIC_kwDOHHJsJc4CcL42",reactionsEnabled:0,emitMetadata:0,inputPosition:"top",lang:"zh-TW",loading:"lazy",theme:s.value},r=L(!1),m=L(null),n=A(()=>{const o=[];if(r.value){const c={src:"https://giscus.app/client.js",crossorigin:"anonymous"};Object.keys(a).forEach(i=>{c[`data-${Me(i)}`]=a[i]}),o.push(c)}return o});N({script:n}),G(s,()=>{const o=m.value.querySelector("iframe.giscus-frame");o&&o instanceof HTMLIFrameElement&&o.contentWindow.postMessage({giscus:{setConfig:{theme:s.value}}},"https://giscus.app")});const l=o=>{o&&!r.value&&(r.value=!0)};return(o,c)=>U((u(),h("div",{ref_key:"comments",ref:m,class:"giscus"},null,512)),[[g(Be),l]])}},Oe=({description:e="",title:t="",img:s="",url:a="",tags:r=[],createdAt:m="",updatedAt:n=""})=>{const l=[{key:"description",name:"description",content:e},{key:"og:url",property:"og:url",content:a},{key:"og:type",property:"og:type",content:"article"},{key:"og:title",property:"og:title",content:t},{key:"og:description",property:"og:description",content:e},{key:"og:image",property:"og:image",content:s},{key:"og:article:published_time",property:"og:article:published_time",content:m},{key:"og:article:modified_time",property:"og:article:modified_time",content:n}];return r.forEach(o=>{l.push({property:"og:article:tag",content:o})}),{title:t,meta:l,script:[{hid:"article-json-ld",type:"application/ld+json",innerHTML:JSON.stringify({"@context":"https://schema.org","@type":"BlogPosting",headline:t,image:[s],datePublished:m,dateModified:n,author:[{"@type":"Person",name:"HuangChingChieh",url:"https://huangchingchieh.github.io/"}]})}]}},Pe=e=>{if(!e)throw new Error("Need slug to find article!");return O(e,()=>P("articles").where({slug:e}).findOne(),"$SpfYyUQ7eF")},Re=async(e={tags:[],slug:""})=>O(`Related_${e.slug}`,async()=>{const t=await P("articles").only([...W.card,"tags"]).sort({createdAt:-1}).find(),s=[],a={},r=e.tags,m=e.slug;if(!Array.isArray(r)||r.length===0)return s;t.forEach(l=>{const{tags:o,slug:c}=l;if(!Array.isArray(o)||m===c)return;const i=o.reduce((p,$)=>p+r.some(k=>typeof $=="string"&&typeof k=="string"&&$.toLowerCase()===k.toLowerCase()),0);i!==0&&(a[i]||(a[i]=[]),a[i].push(l))});const n=Object.keys(a);if(n.length>0){n.sort((c,i)=>i-c);const l=3;let o=0;for(;o<n.length&&s.length<l;){const c=a[n[o]];c.length>0?s.push(c.pop()):o++}}return s}),Ge={__name:"[slug]",async setup(e){let t,s;const a=re();K((c,i,p)=>{a.toc=[],p()});const r=Y(),{slug:m}=r.params,{data:n}=([t,s]=S(()=>Pe(m)),t=await t,s(),t);n!=null&&n.value?a.toc=n.value.body.toc.links:X()({statusCode:"404"});const{data:l}=([t,s]=S(()=>Re(g(n))),t=await t,s(),t),o=A(()=>{let c=[];if(n!=null&&n.value){const{appHost:i,imageServer:p}=te().public,{title:$,description:k,img:x,tags:R,updatedAt:T,createdAt:I}=n.value,D=i+r.fullPath.substring(1);c=Oe({description:k,url:D,title:$,img:x?`${p}1600x1200q100/${x}`:`${i}images/default-og.png`,tags:R,updatedAt:T,createdAt:I})}return c});return N(o.value),(c,i)=>{const p=q;return u(),_(p,{cols:"12",lg:"10",xl:"8",class:"mx-auto"},{default:b(()=>[d(Z,null,{default:b(()=>[d(ke,{document:g(n)},null,8,["document"])]),_:1}),C("hr",{class:f(["d-block",`d-${g(ee)}-none`])},null,2),d(Se,{class:"mt-5 d-flex justify-content-center"}),d(Ne,{class:"mt-5"}),d(je,{article:g(n),class:"mt-5",articles:g(l)},null,8,["article","articles"])]),_:1})}}};export{Ge as default};
