{"_path":"/articles/2024/nuxt2_to_nuxt3_blog_1_ui","_dir":"2024","_draft":false,"_partial":false,"_locale":"","title":"部落格Nuxt 2升級Nuxt 3（一）：bootstrapVue置換成自製的bootrap5元件","description":"如之前規劃，部落格升級 Nuxt3 的第一步是先把 bootstrapVue 抽換成自己實做的 bootstrap5。這篇是紀錄過程中覺得特別困難或是需要研究的部份。","img":"924/Ia2nWi.png","tags":["blog","nuxt","vue","nuxt2","nuxt3","bootstrapVue","bootstrap 4","bootstrap 5","bootstrap"],"category":"frontend","readingTime":{"text":"4 min read","minutes":3.53,"time":211800,"words":706},"excerpt":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"如"},{"type":"element","tag":"article-inner-link","props":{"slug":"nuxt2_to_nuxt3_blog_0_intro"},"children":[{"type":"text","value":"之前規劃"}]},{"type":"text","value":"，部落格升級 Nuxt3 的第一步是先把 bootstrapVue 抽換成自己實做的 bootstrap5。這篇是紀錄過程中覺得特別困難或是需要研究的部份。"}]}]},"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"如"},{"type":"element","tag":"article-inner-link","props":{"slug":"nuxt2_to_nuxt3_blog_0_intro"},"children":[{"type":"text","value":"之前規劃"}]},{"type":"text","value":"，部落格升級 Nuxt3 的第一步是先把 bootstrapVue 抽換成自己實做的 bootstrap5。這篇是紀錄過程中覺得特別困難或是需要研究的部份。"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"modal"},"children":[{"type":"text","value":"Modal"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"元件中比較麻煩的是 Modal，原生的 Bootstrap 的 Modal 會在"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"body"}]},{"type":"text","value":"加上一個"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"div.modal-backdrop"}]},{"type":"text","value":"元素作為底層，原本的"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".modal"}]},{"type":"text","value":"元素則保留在原本的位置，如果遇到上層元素有"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"position: sticky;"}]},{"type":"text","value":"或是"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"position: absolute"}]},{"type":"text","value":"等等會用到"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"z-index"}]},{"type":"text","value":"的 css 屬性，會導致"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".modal"}]},{"type":"text","value":"元素因為跟著上層元素的"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"z-index"}]},{"type":"text","value":"計算而被"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"div.modal-backdrop"}]},{"type":"text","value":"遮住。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"例如："}]},{"type":"element","tag":"pre","props":{"className":"language-html shiki shiki-themes github-dark","code":"<header class=\"position-stickty\" style=\"z-index: 10;\">\n  <div class=\"modal\"></div>\n</header>\n","language":"html","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#85E89D"},"children":[{"type":"text","value":"header"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" class"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":"\"position-stickty\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" style"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":"\"z-index: 10;\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"  <"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#85E89D"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" class"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":"\"modal\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"></"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#85E89D"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#85E89D"},"children":[{"type":"text","value":"header"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":">\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"原本 bootstrapVue 的作法，是把"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".modal-backdrop"}]},{"type":"text","value":"元素連同"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".modal"}]},{"type":"text","value":"元素一起加到"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"body"}]},{"type":"text","value":"裡面，使其脫離可能受影響的父層，猜想這邊應該是使用"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"$mount"}]},{"type":"text","value":"去做處理。但因為部落格用到的 modal 元件很少而且全部都在 header 裡面（基本上等於全域），所以就乾脆移轉到"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"layouts/default.vue"}]},{"type":"text","value":"元件裡了，開關則從 store 做處理。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"畢竟之後還會再更換 UI 框架，這邊就簡單處理，升上 Nuxt 3 之後再直接使用"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"<Teleport>"}]},{"type":"text","value":"元件。"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"directives"},"children":[{"type":"text","value":"Directives"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"第二麻煩的則是 directives，部落格用到的 bootstrapVue directives 有兩個："},{"type":"element","tag":"a","props":{"href":"https://bootstrap-vue.org/docs/directives/visible","rel":["nofollow"]},"children":[{"type":"text","value":"Visible"}]},{"type":"text","value":"、"},{"type":"element","tag":"a","props":{"href":"https://bootstrap-vue.org/docs/directives/scrollspy","rel":["nofollow"]},"children":[{"type":"text","value":"Scollspy"}]},{"type":"text","value":"。"}]},{"type":"element","tag":"h3","props":{"id":"visible"},"children":[{"type":"text","value":"Visible"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"因為之前已經有使用 IntersectionObserver 實做延遲載入的經驗，自己覺得 Visible 不算太難。自己寫起來大概長這樣："}]},{"type":"element","tag":"pre","props":{"className":"language-js shiki shiki-themes github-dark","code":"let intersectionObserver = null\n\nexport default {\n  inserted(el, { value }) {\n    if (typeof value === 'function') {\n      intersectionObserver = new IntersectionObserver((entries) => {\n        value(entries[0].intersectionRatio > 0)\n      })\n\n      intersectionObserver.observe(el)\n    }\n  },\n  unbind() {\n    if (\n      intersectionObserver &&\n      intersectionObserver instanceof IntersectionObserver\n    ) {\n      intersectionObserver.disconnect()\n    }\n  },\n}\n","filename":"bVisible.js","language":"js","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" intersectionObserver "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" null\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"export"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" default"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"  inserted"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FFAB70"},"children":[{"type":"text","value":"el"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":", { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FFAB70"},"children":[{"type":"text","value":"value"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" }) {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"    if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"typeof"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" value "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" 'function'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"      intersectionObserver "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" new"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" IntersectionObserver"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"(("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FFAB70"},"children":[{"type":"text","value":"entries"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"        value"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"(entries["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"].intersectionRatio "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":">"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"      })\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"      intersectionObserver."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"observe"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"(el)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"  },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"  unbind"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"    if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" (\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"      intersectionObserver "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"&&\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"      intersectionObserver "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"instanceof"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" IntersectionObserver\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"    ) {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"      intersectionObserver."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"disconnect"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"  },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"scrollspy"},"children":[{"type":"text","value":"Scrollspy"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Scrollspy 是 bootstrap "},{"type":"element","tag":"a","props":{"href":"https://getbootstrap.com/docs/5.3/components/scrollspy/","rel":["nofollow"]},"children":[{"type":"text","value":"原生內建的功能"}]},{"type":"text","value":"，主要目的是用來偵測滾動的元素 ID 若與在"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".nav .nav-item .nav-link"}]},{"type":"text","value":"裡面"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"href"}]},{"type":"text","value":"的"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"hash"}]},{"type":"text","value":"相符的話，就給予"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"active"}]},{"type":"text","value":"的 class。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"自己寫出來大概長這樣："}]},{"type":"element","tag":"pre","props":{"className":"language-js shiki shiki-themes github-dark","code":"let Scrollspy = null\nlet scrollSpy = null\n\nexport default {\n  inserted(target) {\n    if (process.client) {\n      if (!Scrollspy) Scrollspy = require('bootstrap/js/dist/scrollspy')\n      scrollSpy = new Scrollspy(document.body, { target })\n    }\n  },\n  unbind() {\n    scrollSpy.dispose()\n  },\n  componentUpdated() {\n    scrollSpy.refresh()\n  },\n}\n","filename":"bScrollspy.js","language":"js","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" Scrollspy "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" null\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"let"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" scrollSpy "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" null\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"export"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" default"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"  inserted"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FFAB70"},"children":[{"type":"text","value":"target"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"    if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" (process.client) {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"      if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"!"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"Scrollspy) Scrollspy "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":"'bootstrap/js/dist/scrollspy'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"      scrollSpy "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" new"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" Scrollspy"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"(document.body, { target })\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"  },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"  unbind"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"    scrollSpy."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"dispose"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"  },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"  componentUpdated"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"    scrollSpy."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"refresh"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"  },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"因為 Scrollspy 包含 client 端的程式碼操作，要判斷"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"process.client"}]},{"type":"text","value":"才初始化，否則使用"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"npm run dev"}]},{"type":"text","value":"或是"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"npm run generate"}]},{"type":"text","value":"時會有錯誤。"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"暗黑模式"},"children":[{"type":"text","value":"暗黑模式"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"最後是暗黑模式，bootstrap5 內建"},{"type":"element","tag":"a","props":{"href":"https://getbootstrap.com/docs/5.3/customize/color-modes/#dark-mode","rel":["nofollow"]},"children":[{"type":"text","value":"暗黑模式"}]},{"type":"text","value":"，使用方式也滿簡單的，就是直接在"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"html"}]},{"type":"text","value":"標籤上加上"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"data-bs-theme=\"dark\""}]},{"type":"text","value":"："}]},{"type":"element","tag":"pre","props":{"className":"language-html shiki shiki-themes github-dark","code":"<html data-bs-theme=\"dark\"></html>\n","language":"html","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#85E89D"},"children":[{"type":"text","value":"html"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" data-bs-theme"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":"\"dark\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"></"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#85E89D"},"children":[{"type":"text","value":"html"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":">\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"基本的元件若沒有用"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"text-white"}]},{"type":"text","value":"或是"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"bg-white"}]},{"type":"text","value":"之類的樣式覆寫，就會自動根據暗黑模式而更改了，若有需要特別區分出像這個部落格一樣的前景、背景色之類的，可以參考"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"node_modules/bootstrap/scss/variables-dark\""}]},{"type":"text","value":"檔案，去使用已經內建的一些變數來簡單做出暗黑模式。"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"後記"},"children":[{"type":"text","value":"後記"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在部落格升級的過程中，自己覺得比較困難或要特別注意的就是上述這幾個了。其他像原本代表左右的"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"l"}]},{"type":"text","value":"與"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"r"}]},{"type":"text","value":"要換成"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"start"}]},{"type":"text","value":"與"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"end"}]},{"type":"text","value":"、圓角使用的"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"rounded"}]},{"type":"text","value":"大小不再是使用"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sm"}]},{"type":"text","value":"/"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"lg"}]},{"type":"text","value":"這種而是轉用數字……之類的小事，直接看"},{"type":"element","tag":"a","props":{"href":"https://getbootstrap.com/docs/5.3/migration/","rel":["nofollow"]},"children":[{"type":"text","value":"官方的升級指引"}]},{"type":"text","value":"就 OK。"}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"modal","depth":2,"text":"Modal"},{"id":"directives","depth":2,"text":"Directives","children":[{"id":"visible","depth":3,"text":"Visible"},{"id":"scrollspy","depth":3,"text":"Scrollspy"}]},{"id":"暗黑模式","depth":2,"text":"暗黑模式"},{"id":"後記","depth":2,"text":"後記"}]}},"_type":"markdown","_id":"content:articles:2024:nuxt2_to_nuxt3_blog_1_ui.md","_source":"content","_file":"articles/2024/nuxt2_to_nuxt3_blog_1_ui.md","_stem":"articles/2024/nuxt2_to_nuxt3_blog_1_ui","_extension":"md","createdAt":"2024-01-23T05:33:23.000Z","updatedAt":"2024-01-24T07:26:04.000Z","slug":"nuxt2_to_nuxt3_blog_1_ui","plainTexts":["如","之前規劃","，部落格升級 Nuxt3 的第一步是先把 bootstrapVue 抽換成自己實做的 bootstrap5。這篇是紀錄過程中覺得特別困難或是需要研究的部份。","Modal","元件中比較麻煩的是 Modal，原生的 Bootstrap 的 Modal 會在","body","加上一個","div.modal-backdrop","元素作為底層，原本的",".modal","元素則保留在原本的位置，如果遇到上層元素有","position: sticky;","或是","position: absolute","等等會用到","z-index","的 css 屬性，會導致",".modal","元素因為跟著上層元素的","z-index","計算而被","div.modal-backdrop","遮住。","例如：","<","header","class","=","\"position-stickty\"","style","=","\"z-index: 10;\"",">","<","div","class","=","\"modal\"","></","div",">","</","header",">","原本 bootstrapVue 的作法，是把",".modal-backdrop","元素連同",".modal","元素一起加到","body","裡面，使其脫離可能受影響的父層，猜想這邊應該是使用","$mount","去做處理。但因為部落格用到的 modal 元件很少而且全部都在 header 裡面（基本上等於全域），所以就乾脆移轉到","layouts/default.vue","元件裡了，開關則從 store 做處理。","畢竟之後還會再更換 UI 框架，這邊就簡單處理，升上 Nuxt 3 之後再直接使用","<Teleport>","元件。","Directives","第二麻煩的則是 directives，部落格用到的 bootstrapVue directives 有兩個：","Visible","、","Scollspy","。","Visible","因為之前已經有使用 IntersectionObserver 實做延遲載入的經驗，自己覺得 Visible 不算太難。自己寫起來大概長這樣：","let","intersectionObserver","=","null","","export","default","{","inserted","(","el",", {","value","}) {","if","(","typeof","value","===","'function'",") {","intersectionObserver","=","new","IntersectionObserver","((","entries",")","=>","{","value","(entries[","0","].intersectionRatio",">","0",")","})","","intersectionObserver.","observe","(el)","}","},","unbind","() {","if","(","intersectionObserver","&&","intersectionObserver","instanceof","IntersectionObserver",") {","intersectionObserver.","disconnect","()","}","},","}","Scrollspy","Scrollspy 是 bootstrap","原生內建的功能","，主要目的是用來偵測滾動的元素 ID 若與在",".nav .nav-item .nav-link","裡面","href","的","hash","相符的話，就給予","active","的 class。","自己寫出來大概長這樣：","let","Scrollspy","=","null","let","scrollSpy","=","null","","export","default","{","inserted","(","target",") {","if","(process.client) {","if","(","!","Scrollspy) Scrollspy","=","require","(","'bootstrap/js/dist/scrollspy'",")","scrollSpy","=","new","Scrollspy","(document.body, { target })","}","},","unbind","() {","scrollSpy.","dispose","()","},","componentUpdated","() {","scrollSpy.","refresh","()","},","}","因為 Scrollspy 包含 client 端的程式碼操作，要判斷","process.client","才初始化，否則使用","npm run dev","或是","npm run generate","時會有錯誤。","暗黑模式","最後是暗黑模式，bootstrap5 內建","暗黑模式","，使用方式也滿簡單的，就是直接在","html","標籤上加上","data-bs-theme=\"dark\"","：","<","html","data-bs-theme","=","\"dark\"","></","html",">","基本的元件若沒有用","text-white","或是","bg-white","之類的樣式覆寫，就會自動根據暗黑模式而更改了，若有需要特別區分出像這個部落格一樣的前景、背景色之類的，可以參考","node_modules/bootstrap/scss/variables-dark\"","檔案，去使用已經內建的一些變數來簡單做出暗黑模式。","後記","在部落格升級的過程中，自己覺得比較困難或要特別注意的就是上述這幾個了。其他像原本代表左右的","l","與","r","要換成","start","與","end","、圓角使用的","rounded","大小不再是使用","sm","/","lg","這種而是轉用數字……之類的小事，直接看","官方的升級指引","就 OK。","html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"]}