{"_path":"/articles/2024/crypto_liquidity_mining_v3","_dir":"2024","_draft":false,"_partial":false,"_locale":"","title":"流動性挖礦v3心得記錄","description":"在 2023 年 4 月 1 日 Uniswap v3 原始碼許可證過期後，許多其他鏈上的龍頭交易所已紛紛分叉其原始碼並將流動性挖礦功能升級到 v3，大部分的 v2 流動性礦池已無利益可言，原本我在 Pancakeswap 上的 v2 流動性也須隨之轉換。","img":"922/wa2rhz.jpg","tags":["DeFi","投資","流動性挖礦","加密貨幣"],"category":"life","readingTime":{"text":"11 min read","minutes":10.595,"time":635700,"words":2119},"excerpt":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在 2023 年 4 月 1 日 Uniswap v3 "},{"type":"element","tag":"a","props":{"href":"https://support.uniswap.org/hc/en-us/articles/14569783029645-Uniswap-v3-Licensing","rel":["nofollow"]},"children":[{"type":"text","value":"原始碼許可證過期"}]},{"type":"text","value":"後，許多其他鏈上的龍頭交易所已紛紛分叉其原始碼並將流動性挖礦功能升級到 v3，大部分的 v2 流動性礦池已無利益可言，原本我在 Pancakeswap 上的 v2 流動性也須隨之轉換。"}]}]},"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在 2023 年 4 月 1 日 Uniswap v3 "},{"type":"element","tag":"a","props":{"href":"https://support.uniswap.org/hc/en-us/articles/14569783029645-Uniswap-v3-Licensing","rel":["nofollow"]},"children":[{"type":"text","value":"原始碼許可證過期"}]},{"type":"text","value":"後，許多其他鏈上的龍頭交易所已紛紛分叉其原始碼並將流動性挖礦功能升級到 v3，大部分的 v2 流動性礦池已無利益可言，原本我在 Pancakeswap 上的 v2 流動性也須隨之轉換。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"然而 v3 比起 v2 複雜許多，也不像 v2 那麼無腦賺了，管理流動性變成需要多所琢磨的日常事務之一。"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"關於流動性挖礦"},"children":[{"type":"text","value":"關於流動性挖礦"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"這部份就讓我引用之前寫的文章："},{"type":"element","tag":"article-inner-link","props":{"slug":"crypto_liquidity_mining_v2"},"children":[]},{"type":"text","value":"，對於流動性挖礦還沒有概念或是好奇我為何選擇流動性挖礦的人，可以點過去看看。"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"關於-v2-與-v3-的差異"},"children":[{"type":"text","value":"關於 v2 與 v3 的差異"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"v2 與 v3 最大的差異，就在於 v3 投入流動性時要決定"},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"提供流動性的價格範圍"}]},{"type":"text","value":"以及"},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"賺取的手續費率"}]},{"type":"text","value":"。藉由決定流動性價格範圍來提高流動性利用率，是 v3 比起 v2 能夠取得更高報酬的主因。"}]},{"type":"element","tag":"article-note","props":{},"children":[{"type":"text","value":"\n關於 Uniswap v2 與 v3 的差異，可參考官方文章：\n"},{"type":"element","tag":"a","props":{"href":"https://blog.uniswap.org/uniswap-v3","rel":["nofollow"]},"children":[{"type":"text","value":"Introducing Uniswap v3"}]},{"type":"text","value":"\n。\n"}]},{"type":"element","tag":"h3","props":{"id":"決定流動性價格範圍"},"children":[{"type":"text","value":"決定流動性價格範圍"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"這半年操作下來，覺得在 v3 投入流動性並決定流動性價格範圍，本身其實可以視為是"},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"在該價格範圍內掛了一連串隨著價格漲跌而執行的買單／賣單"}]},{"type":"text","value":"，在超過價格範圍時，投入的流動性將會被完全買／賣成對應的幣。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"這個部份用文字說起來有些複雜，看"},{"type":"element","tag":"a","props":{"href":"https://blog.uniswap.org/uniswap-v3#active-liquidity","rel":["nofollow"]},"children":[{"type":"text","value":"官方介紹文章"}]},{"type":"text","value":"中使用的影片會比較清楚："}]},{"type":"element","tag":"embed-youtube","props":{"id":"_awCyk72VFA"},"children":[]},{"type":"element","tag":"h3","props":{"id":"決定手續費率"},"children":[{"type":"text","value":"決定手續費率"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"手續費是流動性挖礦的主要收入來源，雖然在 Uniswap v3 中可以自行決定手續費率（1%、0.3%、0.05% 或 0.01%），但在 Pancakeswap v3 中，官方會決定有哪些手續費率的流動性可以進一步質押以獲得額外的 CAKE 幣分發。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"所以這部份我比較無腦，就是跟著官方的決定走。"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"價格範圍的影響"},"children":[{"type":"text","value":"價格範圍的影響"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"既然 v3 相比 v2 增加的報酬是來自於讓流動性集中於價格範圍，流動性的管理與再平衡便成為了 v3 比起 v2 增加的主要風險。"}]},{"type":"element","tag":"article-note","props":{},"children":[{"type":"text","value":"\n再平衡（rebalance）在金融術語中指的是將已經偏離目標比例的投資組合重新修正，在流動性挖礦中就是提領流動性重新設定價格區間再次投入的動作。\n"}]},{"type":"element","tag":"h3","props":{"id":"價格範圍過寬"},"children":[{"type":"text","value":"價格範圍過寬"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"價格範圍寬帶來的影響相對直觀，就是流動性利用率低導致手續費收入大為減少，雖然也比較不用擔心再平衡的議題，但以 Pancakeswap v3 中主推的 BNB / USDT 流動性池來說，提供「全範圍」的年化報酬率也才 3%："}]},{"type":"element","tag":"article-img","props":{"img":"922/9bZAhb.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"是否要踩著加密貨幣不受監管的高風險，然後拿 3％ 的年化報酬就看個人了……。"}]},{"type":"element","tag":"h3","props":{"id":"價格範圍過窄"},"children":[{"type":"text","value":"價格範圍過窄"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"價格範圍過窄雖然會因為流動性的利用率增加而拿到更高的手續費，然而第一個可能會遇到的問題就是再平衡過於頻繁。每次再平衡因為要提出流動性，都會實現無常損失。其次就是要非常關心漲跌幅，勞心勞神。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"不過，上面這些問題都還是可以來得及再平衡的狀況下，可怕的是價格範圍窄到來不及在價格離開設定的範圍之前進行再平衡，持有的流動性沒吃到漲幅或完全吃到跌幅，讓我舉個例子說明："}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"假設我在 USDC:ETH = 2000:1 的價格投入流動性，範圍設定在 1800 ~ 2200 區間："}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"若 ETH 漲到 2200 時，我持有的流動性會全部被轉換成 USDC，此時若 ETH 繼續漲到 2500，但我沒有進行再平衡，等於在 2200 → 2500 這段的漲幅我是沒吃到的。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"相反的，若 ETH 跌到 1800 時，我持有的流動性會全部被轉換成 ETH，此時若 ETH 繼續往下跌到 1600，但我沒有進行再平衡，等於我會完全吃到 1800 → 1600 的跌幅。"}]}]},{"type":"element","tag":"article-note","props":{},"children":[{"type":"text","value":"\n上述所說「全部轉換」的狀況是在價格離開區間之後提出流動性才會發生的，若不提出流動性且價格回到原區間就無此問題。\n"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"那麼，如果我之後在價格範圍外進行再平衡，將已經轉換為單一資產的流動性重新投入為 1:1 的兩種資產，幾乎就等於是"},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"拿一半的錢去買高賣低"}]},{"type":"text","value":"。這種狀況要是多發生幾次，在還沒賺到手續費之前可能很快就把本金燒完了。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"我剛開始沒注意到這件事，以為超出價格範圍進行再平衡也沒關係，執行一兩個月之後發現流動性完全沒有成長，才發現原來賺來的手續費都被這個「買高賣低」消耗掉了。"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"設定策略"},"children":[{"type":"text","value":"設定策略"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"所以，價格範圍如何設得適中，讓自己能夠在舒服的狀況下來得及進行再平衡，減少實現無常損失的次數並持續賺取手續費，就可說是 v3 流動性管理的藝術了。畢竟 v3 不像 v2 可以無腦存入，會有很多個人因素會影響流動性的管理，每個人選擇的幣種跟採取的策略都不同，如同官方文章所說："}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"LPs construct individualized price curves that reflect their own preferences."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"流動性提供者建立反應自身偏好的價格曲線。"}]}]},{"type":"element","tag":"article-note","props":{},"children":[{"type":"text","value":"\n流動性範圍的寬窄與否，跟幣種本身是有關的，若是主流大幣如 BTC / ETH，波動不太大，也許 ±20%就算是滿寬，±5%則太窄；但對於有可能暴漲暴跌的小幣來說，±20%卻可能算窄，±100%說不定只能算適中。\n"}]},{"type":"element","tag":"h3","props":{"id":"流動性管理協議"},"children":[{"type":"text","value":"流動性管理協議"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在 v2 時的流動性管理協議做的事情比較簡單，基本上就是幫你把交易所額外派發的獎勵領出來自動複投。但在 v3 牽涉到價格範圍的設定以及何時再平衡，協議團隊要做的事情相對複雜許多，策略也都各有千秋。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"比較有名的像是以太坊上的 "},{"type":"element","tag":"a","props":{"href":"https://www.arrakis.finance/","rel":["nofollow"]},"children":[{"type":"text","value":"Arrakis"}]},{"type":"text","value":" 或是 "},{"type":"element","tag":"a","props":{"href":"https://www.gamma.xyz/","rel":["nofollow"]},"children":[{"type":"text","value":"Gamma"}]},{"type":"text","value":"，Pancakeswap 上面也有整合 "},{"type":"element","tag":"a","props":{"href":"https://www.alpacafinance.org/","rel":["nofollow"]},"children":[{"type":"text","value":"Alpaca Finance"}]},{"type":"text","value":" 或是 "},{"type":"element","tag":"a","props":{"href":"https://www.bril.finance/","rel":["nofollow"]},"children":[{"type":"text","value":"Bril Finance"}]},{"type":"text","value":"……之類的"},{"type":"element","tag":"a","props":{"href":"https://pancakeswap.finance/position-managers","rel":["nofollow"]},"children":[{"type":"text","value":"倉位管理"}]},{"type":"text","value":"功能。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"只是……手續費真的好高啊！動輒收 10% 讓人有點吐血，雖然可以單幣存入又能自動管理實在是懶人福音，但後來我還是決定自己管理了。而且協議提供的管理策略，沒有對應的金融知識真的是看不懂。俗話說得好，不要投資自己看不懂的東西。"}]},{"type":"element","tag":"h3","props":{"id":"自己採取的策略"},"children":[{"type":"text","value":"自己採取的策略"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"對於會預測漲跌的人來說，可以更巧妙的去設定範圍，看漲的人可以設定將範圍設得往高價偏得更多一些，反之亦然。但由於我當初選擇流動性挖礦的中心思想就是："},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"「我無法預測漲跌」"}]},{"type":"text","value":"，所以我的範圍設定都會是現在價格正負相同的%數。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"延續之前在 v2 中選擇「鏈原生幣 ←→ 穩定幣」幣池的策略，我目前將價格範圍設定在 ±20%，並且固定在抵達 ±10%時再平衡，這是目前我最舒服的作法。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"有在考慮要不要縮短為 ±15% ，不過之前設定 ±10% ，有時候遇到出國旅遊什麼的就會有點來不及再平衡，曾經這樣繳了一次小額學費。"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"後記"},"children":[{"type":"text","value":"後記"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"本來信奉無腦賺的我，在 v2 時搭配自動複投協議，大概一個月才會記一下自己目前的倉位資訊。升級到 v3 後，就開始要把價格資訊釘選到自己手機的主畫面，沒事就要去看一下，當價格到達自己設定的目標時就要趕著做再平衡。雖然自己設定流動性的價格範圍算是寬敞（？），但有時候仍會有一種自己在做交易員的錯覺。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"而"},{"type":"element","tag":"a","props":{"href":"https://abmedia.io/uniswap-v4-q3-launch","rel":["nofollow"]},"children":[{"type":"text","value":"預計在 2024 年 Q3"}]},{"type":"text","value":"上線的 v4，想必又會對 DeFi 世界帶來強烈的變革吧，雖然其他鏈要獲得這份變革要隔一陣子了。"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"關於流動性挖礦","depth":2,"text":"關於流動性挖礦"},{"id":"關於-v2-與-v3-的差異","depth":2,"text":"關於 v2 與 v3 的差異","children":[{"id":"決定流動性價格範圍","depth":3,"text":"決定流動性價格範圍"},{"id":"決定手續費率","depth":3,"text":"決定手續費率"}]},{"id":"價格範圍的影響","depth":2,"text":"價格範圍的影響","children":[{"id":"價格範圍過寬","depth":3,"text":"價格範圍過寬"},{"id":"價格範圍過窄","depth":3,"text":"價格範圍過窄"}]},{"id":"設定策略","depth":2,"text":"設定策略","children":[{"id":"流動性管理協議","depth":3,"text":"流動性管理協議"},{"id":"自己採取的策略","depth":3,"text":"自己採取的策略"}]},{"id":"後記","depth":2,"text":"後記"}]}},"_type":"markdown","_id":"content:articles:2024:crypto_liquidity_mining_v3.md","_source":"content","_file":"articles/2024/crypto_liquidity_mining_v3.md","_stem":"articles/2024/crypto_liquidity_mining_v3","_extension":"md","createdAt":"2024-02-17T07:08:48.000Z","updatedAt":"2024-02-17T07:08:48.000Z","slug":"crypto_liquidity_mining_v3","plainTexts":["在 2023 年 4 月 1 日 Uniswap v3","原始碼許可證過期","後，許多其他鏈上的龍頭交易所已紛紛分叉其原始碼並將流動性挖礦功能升級到 v3，大部分的 v2 流動性礦池已無利益可言，原本我在 Pancakeswap 上的 v2 流動性也須隨之轉換。","然而 v3 比起 v2 複雜許多，也不像 v2 那麼無腦賺了，管理流動性變成需要多所琢磨的日常事務之一。","關於流動性挖礦","這部份就讓我引用之前寫的文章：","，對於流動性挖礦還沒有概念或是好奇我為何選擇流動性挖礦的人，可以點過去看看。","關於 v2 與 v3 的差異","v2 與 v3 最大的差異，就在於 v3 投入流動性時要決定","提供流動性的價格範圍","以及","賺取的手續費率","。藉由決定流動性價格範圍來提高流動性利用率，是 v3 比起 v2 能夠取得更高報酬的主因。","關於 Uniswap v2 與 v3 的差異，可參考官方文章：","Introducing Uniswap v3","。","決定流動性價格範圍","這半年操作下來，覺得在 v3 投入流動性並決定流動性價格範圍，本身其實可以視為是","在該價格範圍內掛了一連串隨著價格漲跌而執行的買單／賣單","，在超過價格範圍時，投入的流動性將會被完全買／賣成對應的幣。","這個部份用文字說起來有些複雜，看","官方介紹文章","中使用的影片會比較清楚：","決定手續費率","手續費是流動性挖礦的主要收入來源，雖然在 Uniswap v3 中可以自行決定手續費率（1%、0.3%、0.05% 或 0.01%），但在 Pancakeswap v3 中，官方會決定有哪些手續費率的流動性可以進一步質押以獲得額外的 CAKE 幣分發。","所以這部份我比較無腦，就是跟著官方的決定走。","價格範圍的影響","既然 v3 相比 v2 增加的報酬是來自於讓流動性集中於價格範圍，流動性的管理與再平衡便成為了 v3 比起 v2 增加的主要風險。","再平衡（rebalance）在金融術語中指的是將已經偏離目標比例的投資組合重新修正，在流動性挖礦中就是提領流動性重新設定價格區間再次投入的動作。","價格範圍過寬","價格範圍寬帶來的影響相對直觀，就是流動性利用率低導致手續費收入大為減少，雖然也比較不用擔心再平衡的議題，但以 Pancakeswap v3 中主推的 BNB / USDT 流動性池來說，提供「全範圍」的年化報酬率也才 3%：","是否要踩著加密貨幣不受監管的高風險，然後拿 3％ 的年化報酬就看個人了……。","價格範圍過窄","價格範圍過窄雖然會因為流動性的利用率增加而拿到更高的手續費，然而第一個可能會遇到的問題就是再平衡過於頻繁。每次再平衡因為要提出流動性，都會實現無常損失。其次就是要非常關心漲跌幅，勞心勞神。","不過，上面這些問題都還是可以來得及再平衡的狀況下，可怕的是價格範圍窄到來不及在價格離開設定的範圍之前進行再平衡，持有的流動性沒吃到漲幅或完全吃到跌幅，讓我舉個例子說明：","假設我在 USDC:ETH = 2000:1 的價格投入流動性，範圍設定在 1800 ~ 2200 區間：","若 ETH 漲到 2200 時，我持有的流動性會全部被轉換成 USDC，此時若 ETH 繼續漲到 2500，但我沒有進行再平衡，等於在 2200 → 2500 這段的漲幅我是沒吃到的。","相反的，若 ETH 跌到 1800 時，我持有的流動性會全部被轉換成 ETH，此時若 ETH 繼續往下跌到 1600，但我沒有進行再平衡，等於我會完全吃到 1800 → 1600 的跌幅。","上述所說「全部轉換」的狀況是在價格離開區間之後提出流動性才會發生的，若不提出流動性且價格回到原區間就無此問題。","那麼，如果我之後在價格範圍外進行再平衡，將已經轉換為單一資產的流動性重新投入為 1:1 的兩種資產，幾乎就等於是","拿一半的錢去買高賣低","。這種狀況要是多發生幾次，在還沒賺到手續費之前可能很快就把本金燒完了。","我剛開始沒注意到這件事，以為超出價格範圍進行再平衡也沒關係，執行一兩個月之後發現流動性完全沒有成長，才發現原來賺來的手續費都被這個「買高賣低」消耗掉了。","設定策略","所以，價格範圍如何設得適中，讓自己能夠在舒服的狀況下來得及進行再平衡，減少實現無常損失的次數並持續賺取手續費，就可說是 v3 流動性管理的藝術了。畢竟 v3 不像 v2 可以無腦存入，會有很多個人因素會影響流動性的管理，每個人選擇的幣種跟採取的策略都不同，如同官方文章所說：","LPs construct individualized price curves that reflect their own preferences.","流動性提供者建立反應自身偏好的價格曲線。","流動性範圍的寬窄與否，跟幣種本身是有關的，若是主流大幣如 BTC / ETH，波動不太大，也許 ±20%就算是滿寬，±5%則太窄；但對於有可能暴漲暴跌的小幣來說，±20%卻可能算窄，±100%說不定只能算適中。","流動性管理協議","在 v2 時的流動性管理協議做的事情比較簡單，基本上就是幫你把交易所額外派發的獎勵領出來自動複投。但在 v3 牽涉到價格範圍的設定以及何時再平衡，協議團隊要做的事情相對複雜許多，策略也都各有千秋。","比較有名的像是以太坊上的","Arrakis","或是","Gamma","，Pancakeswap 上面也有整合","Alpaca Finance","或是","Bril Finance","……之類的","倉位管理","功能。","只是……手續費真的好高啊！動輒收 10% 讓人有點吐血，雖然可以單幣存入又能自動管理實在是懶人福音，但後來我還是決定自己管理了。而且協議提供的管理策略，沒有對應的金融知識真的是看不懂。俗話說得好，不要投資自己看不懂的東西。","自己採取的策略","對於會預測漲跌的人來說，可以更巧妙的去設定範圍，看漲的人可以設定將範圍設得往高價偏得更多一些，反之亦然。但由於我當初選擇流動性挖礦的中心思想就是：","「我無法預測漲跌」","，所以我的範圍設定都會是現在價格正負相同的%數。","延續之前在 v2 中選擇「鏈原生幣 ←→ 穩定幣」幣池的策略，我目前將價格範圍設定在 ±20%，並且固定在抵達 ±10%時再平衡，這是目前我最舒服的作法。","有在考慮要不要縮短為 ±15% ，不過之前設定 ±10% ，有時候遇到出國旅遊什麼的就會有點來不及再平衡，曾經這樣繳了一次小額學費。","後記","本來信奉無腦賺的我，在 v2 時搭配自動複投協議，大概一個月才會記一下自己目前的倉位資訊。升級到 v3 後，就開始要把價格資訊釘選到自己手機的主畫面，沒事就要去看一下，當價格到達自己設定的目標時就要趕著做再平衡。雖然自己設定流動性的價格範圍算是寬敞（？），但有時候仍會有一種自己在做交易員的錯覺。","而","預計在 2024 年 Q3","上線的 v4，想必又會對 DeFi 世界帶來強烈的變革吧，雖然其他鏈要獲得這份變革要隔一陣子了。"]}