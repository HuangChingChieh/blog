<!DOCTYPE html><html  lang="zh-Hant-TW" data-bs-theme="dark"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>部落格Nuxt 2升級Nuxt 3（三）：Nuxt Content v1 → v2｜隨機手札</title>
<script async defer src="https://www.googletagmanager.com/gtag/js?id=G-KHMFPTGCC2"></script>
<script>window.dataLayer = window.dataLayer || []
          function gtag() {
            dataLayer.push(arguments)
          }
          gtag('js', new Date())
    
          gtag('config', 'G-KHMFPTGCC2')</script>
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="format-detection" content="telephone=no">
<meta property="og:site_name" content="隨機手札">
<meta property="og:locale" content="zh_TW">
<meta name="apple-mobile-web-app-title" content="隨機手札">
<link rel="icon" href="https://huangchingchieh.github.io/blog/favicon.ico">
<link rel="apple-touch-icon" href="https://huangchingchieh.github.io/blog//pwa-192x192.png">
<link rel="mask-icon" href="https://huangchingchieh.github.io/blog//maskable-icon-512x512.png">
<link rel="manifest" href="/blog/manifest.webmanifest">
<meta name="description" content="在初步修改非模組的設定值之後，接著就要開始著手模組的升級，這部份是連同改寫為 composition api 一起做的，畢竟不可能只升級特定模組的用法而不去動到其他程式碼，但為了讓文章閱讀容易，就還是分模組來紀錄。">
<meta property="og:url" content="https://huangchingchieh.github.io/blog/nuxt2_to_nuxt3_blog_3_modules_content/">
<meta property="og:type" content="article">
<meta property="og:title" content="部落格Nuxt 2升級Nuxt 3（三）：Nuxt Content v1 → v2">
<meta property="og:description" content="在初步修改非模組的設定值之後，接著就要開始著手模組的升級，這部份是連同改寫為 composition api 一起做的，畢竟不可能只升級特定模組的用法而不去動到其他程式碼，但為了讓文章閱讀容易，就還是分模組來紀錄。">
<meta property="og:image" content="https://imagizer.imageshack.com/v2/1600x1200q100/924/Ia2nWi.png">
<meta property="og:article:published_time" content="2024-01-24T07:26:04.000Z">
<meta property="og:article:modified_time" content="2024-01-24T07:26:04.000Z">
<meta property="og:article:tag" content="blog">
<meta property="og:article:tag" content="nuxt">
<meta property="og:article:tag" content="vue">
<meta property="og:article:tag" content="nuxt2">
<meta property="og:article:tag" content="nuxt3">
<meta property="og:article:tag" content="nuxt content">
<script type="application/ld+json" data-hid="a71723a">{"@context":"https://schema.org","@type":"BlogPosting","headline":"部落格Nuxt 2升級Nuxt 3（三）：Nuxt Content v1 → v2","image":["https://imagizer.imageshack.com/v2/1600x1200q100/924/Ia2nWi.png"],"datePublished":"2024-01-24T07:26:04.000Z","dateModified":"2024-01-24T07:26:04.000Z","author":[{"@type":"Person","name":"HuangChingChieh","url":"https://huangchingchieh.github.io/"}]}</script>
<link rel="preload" as="image" imagesizes="(min-width: 992px) 800px,(min-width: 768px) 640px,640px" data-hid="22f22ce">
<link rel="preload" as="fetch" crossorigin="anonymous" href="/blog/nuxt2_to_nuxt3_blog_3_modules_content/_payload.json?f8fe5c8d-7029-4cbc-9230-200c4a607a00">
<link rel="stylesheet" href="/blog/_nuxt/entry.pF6oSl34.css">
<link rel="stylesheet" href="/blog/_nuxt/default.B05R_InG.css">
<link rel="stylesheet" href="/blog/_nuxt/_slug_.C5-qfIfH.css">
<link rel="stylesheet" href="/blog/_nuxt/article-code.DTugKI8G.css">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/zem-cybl.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/BmkmVuUN.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/BbJ4qIQM.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/iH95Xpvu.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/D2BBNTRy.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/Cpj98o6Y.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/f8xZ8Stw.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/CJ7lJzqn.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/C4W2Za6G.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DHlyf_FN.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/BVlHyBWu.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/BsYmvPZw.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/AqE3jBSQ.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/-XF1hRcZ.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/0la-DMC_.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/CyJ5lLk4.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/D_vWn064.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/3fvVe99b.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/mYXvvC70.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/BZm9i8et.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/BCvJYOVL.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/C71wBj18.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/Ccf4lqPF.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/CSLIdfhK.js">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/DFjpnwFp.js">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/BbOwa5LD.js">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/pb8EdMfC.js">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/dL13QrrR.js">
<script type="module" src="/blog/_nuxt/zem-cybl.js" crossorigin></script>
<script id="unhead:payload" type="application/json">{"titleTemplate":"%s｜隨機手札"}</script></head><body><div style="position:fixed;"></div><!--teleport anchor--><div tabindex="-1" aria-hidden="true" class="modal fade"><div class="modal-dialog modal-dialog-centered modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><div class="modal-title h5">文章分類</div><button type="button" class="btn-close" aria-label="關閉"></button></div><div class="modal-body"><!--[--><ul class="nav flex-column"><!--[--><li class="nav-item"><a href="/blog/category/all/1/" class="nav-link"><!--[-->最新文章<!--]--></a></li><li class="nav-item"><a href="/blog/category/linux/1/" class="nav-link"><!--[-->Linux心得<!--]--></a></li><li class="nav-item"><a href="/blog/category/frontend/1/" class="nav-link"><!--[-->前端筆記<!--]--></a></li><li class="nav-item"><a href="/blog/category/life/1/" class="nav-link"><!--[-->生活雜記<!--]--></a></li><!--]--></ul><!--]--></div></div></div></div><!--teleport anchor--><div tabindex="-1" aria-hidden="true" class="modal fade"><div class="modal-lg modal-dialog modal-dialog-centered modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><div class="modal-title h5">搜尋文章</div><button type="button" class="btn-close" aria-label="關閉"></button></div><div class="modal-body"><!--[--><div class="d-flex flex-column"><div class="_inputGroup_11kzr_8 position-relative"><input value placeholder="請輸入關鍵字" type="text" class="form-control _input_11kzr_8"><div class="_iconWrapper_11kzr_11 d-flex align-items-center justify-content-center px-3"><i class="bi-search _icon_11kzr_11"></i></div></div><div class="_results_11kzr_2 mt-3"><!----></div></div><!--]--></div></div></div></div><!--teleport anchor--><div id="__nuxt"><!--[--><!----><!--[--><header class="pt-sm-4 _header_1ae6h_2"><div class="container container-sm py-sm-3 d-flex flex-row align-items-center"><!--[--><img src="/blog/pwa-64x64.png" height="64" width="64" class="common-icon rounded-circle shadow-sm bordered _bordered_t6qrn_2 _logo_1ae6h_21"><div class="ms-3 flex-grow-1"><a href="/blog/" class="fw-bold text-body d-block text-decoration-none"> 隨機手札 </a><small class="text-muted d-none d-sm-block">雜七雜八之地</small></div><div class="d-flex align-items-center justify-content-end"><div><button class="btn-link btn d-flex align-items-center text-decoration-none ms-4 _icon_1ae6h_25 d-flex" type="button" title="文章分類"><!--[--><i class="bi-folder h5 mb-0 d-flex"></i><!--[--><!--]--><!--]--></button><!--teleport start--><!--teleport end--></div><div><span></span></div><button class="btn-link btn d-flex align-items-center text-decoration-none ms-4 _icon_1ae6h_25 d-flex" type="button"><!--[--><i class="bi-moon-stars h5 mb-0 d-flex"></i><!--[--><!--]--><!--]--></button><div><button class="btn-link btn d-flex align-items-center text-decoration-none ms-4 _icon_1ae6h_25 d-flex" type="button" title="搜尋文章"><!--[--><i class="bi-search h5 mb-0 d-flex"></i><!--[--><!--]--><!--]--></button><!--teleport start--><!--teleport end--></div></div><!--]--></div><div></div></header><main class="container container-sm py-4"><!--[--><!--[--><div><div class="p-sm-5 _container_1s3jf_3"><!--[--><article class="_article_13yi1_2"><h1 class="_title_13yi1_5">部落格Nuxt 2升級Nuxt 3（三）：Nuxt Content v1 → v2</h1><div class="d-flex flex-row align-items-center my-2"><time class="d-flex align-items-center flex-row text-muted small mb-0 _date_13yi1_10"><!--[--><i class="bi-calendar-event me-1"></i><span class="me-3">2024/01/24</span><!--]--></time><span class="text-muted small d-inline-flex align-items-center"><i class="bi-clock me-1"></i><span class="me-3">7 min</span></span><a href="/blog/category/frontend/1/" class="text-muted small d-inline-flex align-items-center"><i class="bi-folder me-1"></i><span>前端筆記</span></a></div><div class="_tags_13yi1_13 d-flex flex-wrap my-2"><!--[--><span class="badge bg-secondary text-bg-secondary d-inline-block fw-normal font-monospace me-1 mb-1"><!--[--> #<!--[-->blog<!--]--><!--]--></span><span class="badge bg-secondary text-bg-secondary d-inline-block fw-normal font-monospace me-1 mb-1"><!--[--> #<!--[-->nuxt<!--]--><!--]--></span><span class="badge bg-secondary text-bg-secondary d-inline-block fw-normal font-monospace me-1 mb-1"><!--[--> #<!--[-->vue<!--]--><!--]--></span><span class="badge bg-secondary text-bg-secondary d-inline-block fw-normal font-monospace me-1 mb-1"><!--[--> #<!--[-->nuxt2<!--]--><!--]--></span><span class="badge bg-secondary text-bg-secondary d-inline-block fw-normal font-monospace me-1 mb-1"><!--[--> #<!--[-->nuxt3<!--]--><!--]--></span><span class="badge bg-secondary text-bg-secondary d-inline-block fw-normal font-monospace me-1 mb-1"><!--[--> #<!--[-->nuxt content<!--]--><!--]--></span><!--]--></div><div class="position-relative rounded _banner_13yi1_16"><img srcset="https://imagizer.imageshack.com/v2/100x75q70/924/Ia2nWi.png 100w, https://imagizer.imageshack.com/v2/150x100q70/924/Ia2nWi.png 150w, https://imagizer.imageshack.com/v2/280x200q70/924/Ia2nWi.png 280w, https://imagizer.imageshack.com/v2/320x240q70/924/Ia2nWi.png 320w, https://imagizer.imageshack.com/v2/640x480q70/924/Ia2nWi.png 640w, https://imagizer.imageshack.com/v2/800x600q70/924/Ia2nWi.png 800w, https://imagizer.imageshack.com/v2/1024x768q70/924/Ia2nWi.png 1024w, https://imagizer.imageshack.com/v2/1280x1024q70/924/Ia2nWi.png 1280w, https://imagizer.imageshack.com/v2/1600x1200q70/924/Ia2nWi.png 1600w" class="_img_5u372_2 rounded" loading="lazy"></div><div class="nuxt-content"><p><!--[-->在<a href="/blog/nuxt2_to_nuxt3_blog_2_settings/" class=""><!--[-->初步修改非模組的設定值<!--]--></a>之後，接著就要開始著手模組的升級，這部份是連同改寫為 composition api 一起做的，畢竟不可能只升級特定模組的用法而不去動到其他程式碼，但為了讓文章閱讀容易，就還是分模組來紀錄。<!--]--></p><p><!--[-->那麼，首先是部落格最重要的驅動基底：Nuxt Content。<!--]--></p><hr><h2 id="相關資料夾結構修改"><!--[-->相關資料夾結構修改<!--]--></h2><p><!--[-->第一步先來修改相關的資料夾結構。<!--]--></p><h3 id="content-資料夾"><!--[-->content 資料夾<!--]--></h3><p><!--[-->原本<code class=""><!--[-->content<!--]--></code>資料夾中下面的子資料夾結構是：<!--]--></p><ul><!--[--><li><!--[--><code class=""><!--[-->articles/年份/文章們.md<!--]--></code><!--]--></li><li><!--[--><code class=""><!--[-->draft/草稿們.md<!--]--></code><!--]--></li><!--]--></ul><p><!--[-->這部份的<code class=""><!--[-->draft<!--]--></code>原本是透過查詢時直接排除，不過 Nuxt Content v2 可以透過前面加上一個<code class=""><!--[-->.<!--]--></code>來讓整個資料夾及其下的文章「隱身」，參考<a href="https://content.nuxt.com/usage/content-directory" target="_blank" rel="noopener noreferrer nofollow"><!--[--><!--[-->官方文件<!--]--><!--]--></a>修改如下：<!--]--></p><ul><!--[--><li><!--[--><code class=""><!--[-->.draft/草稿們.md<!--]--></code><!--]--></li><!--]--></ul><p><!--[--><code class=""><!--[-->articles<!--]--></code>的部份就不用動了。<!--]--></p><h3 id="componentsglobal-componentscontent"><!--[-->components/global → components/content<!--]--></h3><p><!--[-->若要在文章中直接使用元件，原本是放在<code class=""><!--[-->components/global<!--]--></code>，Nuxt Content v2 中要改放在<code class=""><!--[-->components/content<!--]--></code>裡面。<!--]--></p><hr><h2 id="nuxt-content-git"><!--[-->nuxt-content-git<!--]--></h2><p><!--[-->這個模組沒什麼需要修改的，直接<code class=""><!--[-->npm install nuxt-content-git<!--]--></code>然後在設定值中的<code class=""><!--[-->modules<!--]--></code>啟用就可以了，使用原因可以看之前的文章：<a href="/blog/nuxt2_content_git/" class=""><!--[-->《使用nuxt-content-git取得Nuxt2 Content中正確的檔案時間》<!--]--></a><!--]--></p><hr><h2 id="為文章新增-reading-time"><!--[-->為文章新增 reading-time<!--]--></h2><p><!--[-->在 Nuxt Content v1 時我使用<code class=""><!--[-->hooks<!--]--></code>中的<code class=""><!--[-->content:file:beforeInsert<!--]--></code>來動態計算文章的閱讀時間，不過新版可以直接透過新增 <a href="https://github.com/remarkjs/remark/blob/main/doc/plugins.md" target="_blank" rel="noopener noreferrer nofollow"><!--[--><!--[-->remarkPlugins<!--]--><!--]--></a> 來完成，首先先安裝 reading-time 的 plugin：<!--]--></p><div class="position-relative language-bash shiki shiki-themes github-dark" code="npm install -D remark-reading-time
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#B392F0">npm</span><span style="--shiki-default:#9ECBFF"> install</span><span style="--shiki-default:#79B8FF"> -D</span><span style="--shiki-default:#9ECBFF"> remark-reading-time
</span></span></code><!--]--></pre></div></div><div class="position-relative language-ts shiki shiki-themes github-dark" code="export default defineNuxtConfig({
  content: {
    markdown: {
      // 接著新增設定值
      remarkPlugins: [&#39;remark-reading-time&#39;],
    },
  },
})
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace">nuxt.config.ts</div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#F97583">export</span><span style="--shiki-default:#F97583"> default</span><span style="--shiki-default:#B392F0"> defineNuxtConfig</span><span style="--shiki-default:#E1E4E8">({
</span></span><span class="line" line="2"><span style="--shiki-default:#E1E4E8">  content: {
</span></span><span class="line" line="3"><span style="--shiki-default:#E1E4E8">    markdown: {
</span></span><span class="line" line="4"><span style="--shiki-default:#6A737D">      // 接著新增設定值
</span></span><span class="line" line="5"><span style="--shiki-default:#E1E4E8">      remarkPlugins: [</span><span style="--shiki-default:#9ECBFF">&#39;remark-reading-time&#39;</span><span style="--shiki-default:#E1E4E8">],
</span></span><span class="line" line="6"><span style="--shiki-default:#E1E4E8">    },
</span></span><span class="line" line="7"><span style="--shiki-default:#E1E4E8">  },
</span></span><span class="line" line="8"><span style="--shiki-default:#E1E4E8">})
</span></span></code><!--]--></pre></div></div><p><!--[-->這邊回壓到文章物件身上的<code class=""><!--[-->readingTime<!--]--></code>會是物件，可以看自己需要取出對應的欄位來使用：<!--]--></p><div class="position-relative language-json shiki shiki-themes github-dark" code="{
  &quot;text&quot;: &quot;1 min read&quot;,
  &quot;minutes&quot;: 1,
  &quot;time&quot;: 60000,
  &quot;words&quot;: 200
}
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E1E4E8">{
</span></span><span class="line" line="2"><span style="--shiki-default:#79B8FF">  &quot;text&quot;</span><span style="--shiki-default:#E1E4E8">: </span><span style="--shiki-default:#9ECBFF">&quot;1 min read&quot;</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="3"><span style="--shiki-default:#79B8FF">  &quot;minutes&quot;</span><span style="--shiki-default:#E1E4E8">: </span><span style="--shiki-default:#79B8FF">1</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="4"><span style="--shiki-default:#79B8FF">  &quot;time&quot;</span><span style="--shiki-default:#E1E4E8">: </span><span style="--shiki-default:#79B8FF">60000</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="5"><span style="--shiki-default:#79B8FF">  &quot;words&quot;</span><span style="--shiki-default:#E1E4E8">: </span><span style="--shiki-default:#79B8FF">200
</span></span><span class="line" line="6"><span style="--shiki-default:#E1E4E8">}
</span></span></code><!--]--></pre></div></div><hr><h2 id="自定義元件"><!--[-->自定義元件<!--]--></h2><p><!--[-->Nuxt Content v1 中我透過<code class=""><!--[-->content.markdown.highlighter<!--]--></code>來將 markdown 解析出來的 code 區塊<a href="/blog/nuxt2_content_code_block_copy_paste/" class=""><!--[-->包上自己客製的元件來達成複製貼上程式碼功能<!--]--></a>，在 Nuxt Content v2 中可透過直接覆蓋設定值完成：<!--]--></p><div class="position-relative language-ts shiki shiki-themes github-dark" code="export default defineNuxtConfig({
  content: {
    markdown: {
      tags: {
        pre: &#39;ArticleCode&#39;,
      },
    },
  },
})
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace">nuxt.config.ts</div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#F97583">export</span><span style="--shiki-default:#F97583"> default</span><span style="--shiki-default:#B392F0"> defineNuxtConfig</span><span style="--shiki-default:#E1E4E8">({
</span></span><span class="line" line="2"><span style="--shiki-default:#E1E4E8">  content: {
</span></span><span class="line" line="3"><span style="--shiki-default:#E1E4E8">    markdown: {
</span></span><span class="line" line="4"><span style="--shiki-default:#E1E4E8">      tags: {
</span></span><span class="line" line="5"><span style="--shiki-default:#E1E4E8">        pre: </span><span style="--shiki-default:#9ECBFF">&#39;ArticleCode&#39;</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="6"><span style="--shiki-default:#E1E4E8">      },
</span></span><span class="line" line="7"><span style="--shiki-default:#E1E4E8">    },
</span></span><span class="line" line="8"><span style="--shiki-default:#E1E4E8">  },
</span></span><span class="line" line="9"><span style="--shiki-default:#E1E4E8">})
</span></span></code><!--]--></pre></div></div><p><!--[-->方便好多 XD。<!--]--></p><hr><h2 id="自行補上-slug"><!--[-->自行補上 slug<!--]--></h2><p><!--[-->在 Nuxt Content v1 中，文章本身的檔名會變成<code class=""><!--[-->slug<!--]--></code>屬性，但在 v2 中則是使用<code class=""><!--[-->_id<!--]--></code>而且會是串上文章所屬路徑的，例如這樣：<!--]--></p><div class="position-relative language-json shiki shiki-themes github-dark" code="{
  &quot;_id&quot;: &quot;content:articles:2024:nuxt2_to_nuxt3_blog_3_modules_content.md&quot;
}
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E1E4E8">{
</span></span><span class="line" line="2"><span style="--shiki-default:#79B8FF">  &quot;_id&quot;</span><span style="--shiki-default:#E1E4E8">: </span><span style="--shiki-default:#9ECBFF">&quot;content:articles:2024:nuxt2_to_nuxt3_blog_3_modules_content.md&quot;
</span></span><span class="line" line="3"><span style="--shiki-default:#E1E4E8">}
</span></span></code><!--]--></pre></div></div><p><!--[-->由於我原本使用滿多<code class=""><!--[-->slug<!--]--></code>來做事，若要修改為使用<code class=""><!--[-->_id<!--]--></code>變動會太大，所以這邊使用 <a href="https://content.nuxt.com/recipes/hooks" target="_blank" rel="noopener noreferrer nofollow"><!--[--><!--[-->Hooks<!--]--><!--]--></a> 來自己補上<code class=""><!--[-->slug<!--]--></code>的欄位，根據官方文件需要新增一個檔案<code class=""><!--[-->server/plugins/content.js<!--]--></code>：<!--]--></p><div class="position-relative language-js shiki shiki-themes github-dark" code="export default defineNitroPlugin((nitroApp) =&gt; {
  nitroApp.hooks.hook(&#39;content:file:afterParse&#39;, (file) =&gt; {
    const slug = file._path.split(&#39;/&#39;).pop()
    file.slug = slug
  })
})
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace">server/plugins/content.js</div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#F97583">export</span><span style="--shiki-default:#F97583"> default</span><span style="--shiki-default:#B392F0"> defineNitroPlugin</span><span style="--shiki-default:#E1E4E8">((</span><span style="--shiki-default:#FFAB70">nitroApp</span><span style="--shiki-default:#E1E4E8">) </span><span style="--shiki-default:#F97583">=&gt;</span><span style="--shiki-default:#E1E4E8"> {
</span></span><span class="line" line="2"><span style="--shiki-default:#E1E4E8">  nitroApp.hooks.</span><span style="--shiki-default:#B392F0">hook</span><span style="--shiki-default:#E1E4E8">(</span><span style="--shiki-default:#9ECBFF">&#39;content:file:afterParse&#39;</span><span style="--shiki-default:#E1E4E8">, (</span><span style="--shiki-default:#FFAB70">file</span><span style="--shiki-default:#E1E4E8">) </span><span style="--shiki-default:#F97583">=&gt;</span><span style="--shiki-default:#E1E4E8"> {
</span></span><span class="line" line="3"><span style="--shiki-default:#F97583">    const</span><span style="--shiki-default:#79B8FF"> slug</span><span style="--shiki-default:#F97583"> =</span><span style="--shiki-default:#E1E4E8"> file._path.</span><span style="--shiki-default:#B392F0">split</span><span style="--shiki-default:#E1E4E8">(</span><span style="--shiki-default:#9ECBFF">&#39;/&#39;</span><span style="--shiki-default:#E1E4E8">).</span><span style="--shiki-default:#B392F0">pop</span><span style="--shiki-default:#E1E4E8">()
</span></span><span class="line" line="4"><span style="--shiki-default:#E1E4E8">    file.slug </span><span style="--shiki-default:#F97583">=</span><span style="--shiki-default:#E1E4E8"> slug
</span></span><span class="line" line="5"><span style="--shiki-default:#E1E4E8">  })
</span></span><span class="line" line="6"><span style="--shiki-default:#E1E4E8">})
</span></span></code><!--]--></pre></div></div><hr><h2 id="未穩定的搜尋功能"><!--[-->未穩定的搜尋功能<!--]--></h2><p><!--[-->Nuxt Content v2 有內建滿強大的全文模糊搜尋， v3 的搜尋功能雖然目前仍是「實驗（experimental）」階段，但試做之後沒啥問題，這邊紀錄一下設定跟使用方式。<!--]--></p><h3 id="啟用搜尋功能"><!--[-->啟用搜尋功能<!--]--></h3><p><!--[-->那麼首先是啟用搜尋功能，修改<code class=""><!--[-->nuxt.config.ts<!--]--></code>：<!--]--></p><div class="position-relative language-ts shiki shiki-themes github-dark" code="export default defineNuxtConfig({
  content: {
    experimental: {
      // 官方文件是這樣寫，但這樣會無法通過ts檢查。
      // search: true,
      search: {
        indexed: true,
      },
    },
  },
})
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace">nuxt.config.ts</div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#F97583">export</span><span style="--shiki-default:#F97583"> default</span><span style="--shiki-default:#B392F0"> defineNuxtConfig</span><span style="--shiki-default:#E1E4E8">({
</span></span><span class="line" line="2"><span style="--shiki-default:#E1E4E8">  content: {
</span></span><span class="line" line="3"><span style="--shiki-default:#E1E4E8">    experimental: {
</span></span><span class="line" line="4"><span style="--shiki-default:#6A737D">      // 官方文件是這樣寫，但這樣會無法通過ts檢查。
</span></span><span class="line" line="5"><span style="--shiki-default:#6A737D">      // search: true,
</span></span><span class="line" line="6"><span style="--shiki-default:#E1E4E8">      search: {
</span></span><span class="line" line="7"><span style="--shiki-default:#E1E4E8">        indexed: </span><span style="--shiki-default:#79B8FF">true</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="8"><span style="--shiki-default:#E1E4E8">      },
</span></span><span class="line" line="9"><span style="--shiki-default:#E1E4E8">    },
</span></span><span class="line" line="10"><span style="--shiki-default:#E1E4E8">  },
</span></span><span class="line" line="11"><span style="--shiki-default:#E1E4E8">})
</span></span></code><!--]--></pre></div></div><h3 id="搜尋文章寫法"><!--[-->搜尋文章寫法<!--]--></h3><p><!--[-->搜尋也很容易，以下為自己簡單寫的範例：<!--]--></p><div class="position-relative language-vue shiki shiki-themes github-dark" code="&lt;template&gt;
  &lt;div&gt;
    &lt;input v-model=&quot;keyword&quot; type=&quot;text&quot; /&gt;
    &lt;button type=&quot;button&quot; @click=&quot;refresh&quot;&gt;搜尋&lt;/button&gt;

    &lt;hr /&gt;
    {{ results }}
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
const keyword = ref(&#39;&#39;)

const { data: results, refresh } = await useAsyncData(
  `search:${keyword.value}`,
  () =&gt; searchContent(keyword),
  {
    server: false,
    immediate: false,
    default: () =&gt; [],
  }
)
&lt;/script&gt;
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E1E4E8">&lt;</span><span style="--shiki-default:#85E89D">template</span><span style="--shiki-default:#E1E4E8">&gt;
</span></span><span class="line" line="2"><span style="--shiki-default:#E1E4E8">  &lt;</span><span style="--shiki-default:#85E89D">div</span><span style="--shiki-default:#E1E4E8">&gt;
</span></span><span class="line" line="3"><span style="--shiki-default:#E1E4E8">    &lt;</span><span style="--shiki-default:#85E89D">input</span><span style="--shiki-default:#B392F0"> v-model</span><span style="--shiki-default:#E1E4E8">=</span><span style="--shiki-default:#9ECBFF">&quot;</span><span style="--shiki-default:#E1E4E8">keyword</span><span style="--shiki-default:#9ECBFF">&quot;</span><span style="--shiki-default:#B392F0"> type</span><span style="--shiki-default:#E1E4E8">=</span><span style="--shiki-default:#9ECBFF">&quot;text&quot;</span><span style="--shiki-default:#E1E4E8"> /&gt;
</span></span><span class="line" line="4"><span style="--shiki-default:#E1E4E8">    &lt;</span><span style="--shiki-default:#85E89D">button</span><span style="--shiki-default:#B392F0"> type</span><span style="--shiki-default:#E1E4E8">=</span><span style="--shiki-default:#9ECBFF">&quot;button&quot;</span><span style="--shiki-default:#E1E4E8"> @</span><span style="--shiki-default:#B392F0">click</span><span style="--shiki-default:#E1E4E8">=</span><span style="--shiki-default:#9ECBFF">&quot;</span><span style="--shiki-default:#E1E4E8">refresh</span><span style="--shiki-default:#9ECBFF">&quot;</span><span style="--shiki-default:#E1E4E8">&gt;搜尋&lt;/</span><span style="--shiki-default:#85E89D">button</span><span style="--shiki-default:#E1E4E8">&gt;
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span style="--shiki-default:#E1E4E8">    &lt;</span><span style="--shiki-default:#85E89D">hr</span><span style="--shiki-default:#E1E4E8"> /&gt;
</span></span><span class="line" line="7"><span style="--shiki-default:#E1E4E8">    {{ results }}
</span></span><span class="line" line="8"><span style="--shiki-default:#E1E4E8">  &lt;/</span><span style="--shiki-default:#85E89D">div</span><span style="--shiki-default:#E1E4E8">&gt;
</span></span><span class="line" line="9"><span style="--shiki-default:#E1E4E8">&lt;/</span><span style="--shiki-default:#85E89D">template</span><span style="--shiki-default:#E1E4E8">&gt;
</span></span><span class="line" line="10"><span emptylineplaceholder="true">
</span></span><span class="line" line="11"><span style="--shiki-default:#E1E4E8">&lt;</span><span style="--shiki-default:#85E89D">script</span><span style="--shiki-default:#B392F0"> setup</span><span style="--shiki-default:#E1E4E8">&gt;
</span></span><span class="line" line="12"><span style="--shiki-default:#F97583">const</span><span style="--shiki-default:#79B8FF"> keyword</span><span style="--shiki-default:#F97583"> =</span><span style="--shiki-default:#B392F0"> ref</span><span style="--shiki-default:#E1E4E8">(</span><span style="--shiki-default:#9ECBFF">&#39;&#39;</span><span style="--shiki-default:#E1E4E8">)
</span></span><span class="line" line="13"><span emptylineplaceholder="true">
</span></span><span class="line" line="14"><span style="--shiki-default:#F97583">const</span><span style="--shiki-default:#E1E4E8"> { </span><span style="--shiki-default:#FFAB70">data</span><span style="--shiki-default:#E1E4E8">: </span><span style="--shiki-default:#79B8FF">results</span><span style="--shiki-default:#E1E4E8">, </span><span style="--shiki-default:#79B8FF">refresh</span><span style="--shiki-default:#E1E4E8"> } </span><span style="--shiki-default:#F97583">=</span><span style="--shiki-default:#F97583"> await</span><span style="--shiki-default:#B392F0"> useAsyncData</span><span style="--shiki-default:#E1E4E8">(
</span></span><span class="line" line="15"><span style="--shiki-default:#9ECBFF">  `search:${</span><span style="--shiki-default:#E1E4E8">keyword</span><span style="--shiki-default:#9ECBFF">.</span><span style="--shiki-default:#E1E4E8">value</span><span style="--shiki-default:#9ECBFF">}`</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="16"><span style="--shiki-default:#E1E4E8">  () </span><span style="--shiki-default:#F97583">=&gt;</span><span style="--shiki-default:#B392F0"> searchContent</span><span style="--shiki-default:#E1E4E8">(keyword),
</span></span><span class="line" line="17"><span style="--shiki-default:#E1E4E8">  {
</span></span><span class="line" line="18"><span style="--shiki-default:#E1E4E8">    server: </span><span style="--shiki-default:#79B8FF">false</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="19"><span style="--shiki-default:#E1E4E8">    immediate: </span><span style="--shiki-default:#79B8FF">false</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="20"><span style="--shiki-default:#B392F0">    default</span><span style="--shiki-default:#E1E4E8">: () </span><span style="--shiki-default:#F97583">=&gt;</span><span style="--shiki-default:#E1E4E8"> [],
</span></span><span class="line" line="21"><span style="--shiki-default:#E1E4E8">  }
</span></span><span class="line" line="22"><span style="--shiki-default:#E1E4E8">)
</span></span><span class="line" line="23"><span style="--shiki-default:#E1E4E8">&lt;/</span><span style="--shiki-default:#85E89D">script</span><span style="--shiki-default:#E1E4E8">&gt;
</span></span></code><!--]--></pre></div></div><p><!--[-->會回傳像下面這樣結果的陣列，可以根據需要使用欄位。<!--]--></p><div class="position-relative language-json shiki shiki-themes github-dark" code="[
  {
    &quot;id&quot;: &quot;/articles/2023/buy_me_a_tea#關於隨機手札&quot;,
    &quot;score&quot;: 2.2401858303726176,
    &quot;terms&quot;: [&quot;fedora&quot;],
    &quot;queryTerms&quot;: [&quot;fedore&quot;],
    &quot;match&quot;: { &quot;fedora&quot;: [&quot;content&quot;] },
    &quot;title&quot;: &quot;關於隨機手札&quot;,
    &quot;content&quot;: &quot;……含有關鍵字的文章內容&quot;,
    &quot;titles&quot;: []
  }
]
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E1E4E8">[
</span></span><span class="line" line="2"><span style="--shiki-default:#E1E4E8">  {
</span></span><span class="line" line="3"><span style="--shiki-default:#79B8FF">    &quot;id&quot;</span><span style="--shiki-default:#E1E4E8">: </span><span style="--shiki-default:#9ECBFF">&quot;/articles/2023/buy_me_a_tea#關於隨機手札&quot;</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="4"><span style="--shiki-default:#79B8FF">    &quot;score&quot;</span><span style="--shiki-default:#E1E4E8">: </span><span style="--shiki-default:#79B8FF">2.2401858303726176</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="5"><span style="--shiki-default:#79B8FF">    &quot;terms&quot;</span><span style="--shiki-default:#E1E4E8">: [</span><span style="--shiki-default:#9ECBFF">&quot;fedora&quot;</span><span style="--shiki-default:#E1E4E8">],
</span></span><span class="line" line="6"><span style="--shiki-default:#79B8FF">    &quot;queryTerms&quot;</span><span style="--shiki-default:#E1E4E8">: [</span><span style="--shiki-default:#9ECBFF">&quot;fedore&quot;</span><span style="--shiki-default:#E1E4E8">],
</span></span><span class="line" line="7"><span style="--shiki-default:#79B8FF">    &quot;match&quot;</span><span style="--shiki-default:#E1E4E8">: { </span><span style="--shiki-default:#79B8FF">&quot;fedora&quot;</span><span style="--shiki-default:#E1E4E8">: [</span><span style="--shiki-default:#9ECBFF">&quot;content&quot;</span><span style="--shiki-default:#E1E4E8">] },
</span></span><span class="line" line="8"><span style="--shiki-default:#79B8FF">    &quot;title&quot;</span><span style="--shiki-default:#E1E4E8">: </span><span style="--shiki-default:#9ECBFF">&quot;關於隨機手札&quot;</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="9"><span style="--shiki-default:#79B8FF">    &quot;content&quot;</span><span style="--shiki-default:#E1E4E8">: </span><span style="--shiki-default:#9ECBFF">&quot;……含有關鍵字的文章內容&quot;</span><span style="--shiki-default:#E1E4E8">,
</span></span><span class="line" line="10"><span style="--shiki-default:#79B8FF">    &quot;titles&quot;</span><span style="--shiki-default:#E1E4E8">: []
</span></span><span class="line" line="11"><span style="--shiki-default:#E1E4E8">  }
</span></span><span class="line" line="12"><span style="--shiki-default:#E1E4E8">]
</span></span></code><!--]--></pre></div></div><hr><h2 id="querycontent-與-useasyncdata-的眉角"><!--[-->queryContent 與 useAsyncData 的眉角<!--]--></h2><p><!--[-->在將原本用到<code class=""><!--[-->$content<!--]--></code>查詢文章的部份改寫成<code class=""><!--[-->queryContent<!--]--></code>時踩了一個坑，一度讓我懷疑自己是不是沒搞清楚<code class=""><!--[-->async<!--]--></code>以及<code class=""><!--[-->await<!--]--></code>的用法，後來上網查資料才發現原來是一個<a href="https://github.com/nuxt/content/issues/1368" target="_blank" rel="noopener noreferrer nofollow"><!--[--><!--[-->「特別行為」<!--]--><!--]--></a>。<!--]--></p><p><!--[-->簡單來說，就是你不能在<code class=""><!--[-->useAsyncData<!--]--></code>的回呼函式中<code class=""><!--[-->await<!--]--></code>一個以上的非同步函式，所以像我原本在文章頁中同時查詢文章本身以及其相關文章的作法是不可行的，會報錯，例如像這樣：<!--]--></p><div class="position-relative language-vue shiki shiki-themes github-dark" code="&lt;script setup&gt;
await useAsyncData(slug, async () =&gt; {
  await queryContent()
  await queryContent()
})
&lt;/script&gt;
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E1E4E8">&lt;</span><span style="--shiki-default:#85E89D">script</span><span style="--shiki-default:#B392F0"> setup</span><span style="--shiki-default:#E1E4E8">&gt;
</span></span><span class="line" line="2"><span style="--shiki-default:#F97583">await</span><span style="--shiki-default:#B392F0"> useAsyncData</span><span style="--shiki-default:#E1E4E8">(slug, </span><span style="--shiki-default:#F97583">async</span><span style="--shiki-default:#E1E4E8"> () </span><span style="--shiki-default:#F97583">=&gt;</span><span style="--shiki-default:#E1E4E8"> {
</span></span><span class="line" line="3"><span style="--shiki-default:#F97583">  await</span><span style="--shiki-default:#B392F0"> queryContent</span><span style="--shiki-default:#E1E4E8">()
</span></span><span class="line" line="4"><span style="--shiki-default:#F97583">  await</span><span style="--shiki-default:#B392F0"> queryContent</span><span style="--shiki-default:#E1E4E8">()
</span></span><span class="line" line="5"><span style="--shiki-default:#E1E4E8">})
</span></span><span class="line" line="6"><span style="--shiki-default:#E1E4E8">&lt;/</span><span style="--shiki-default:#85E89D">script</span><span style="--shiki-default:#E1E4E8">&gt;
</span></span></code><!--]--></pre></div></div><p><!--[-->所以，更好的作法就是<strong><!--[-->每個<code class=""><!--[-->useAsyncData<!--]--></code>只包一個<code class=""><!--[-->queryContent<!--]--></code><!--]--></strong>：<!--]--></p><div class="position-relative language-vue shiki shiki-themes github-dark" code="&lt;script setup&gt;
const a = await useAsyncData(slug, () =&gt; queryContent())
const b = await useAsyncData(slug, () =&gt; queryContent())
&lt;/script&gt;
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E1E4E8">&lt;</span><span style="--shiki-default:#85E89D">script</span><span style="--shiki-default:#B392F0"> setup</span><span style="--shiki-default:#E1E4E8">&gt;
</span></span><span class="line" line="2"><span style="--shiki-default:#F97583">const</span><span style="--shiki-default:#79B8FF"> a</span><span style="--shiki-default:#F97583"> =</span><span style="--shiki-default:#F97583"> await</span><span style="--shiki-default:#B392F0"> useAsyncData</span><span style="--shiki-default:#E1E4E8">(slug, () </span><span style="--shiki-default:#F97583">=&gt;</span><span style="--shiki-default:#B392F0"> queryContent</span><span style="--shiki-default:#E1E4E8">())
</span></span><span class="line" line="3"><span style="--shiki-default:#F97583">const</span><span style="--shiki-default:#79B8FF"> b</span><span style="--shiki-default:#F97583"> =</span><span style="--shiki-default:#F97583"> await</span><span style="--shiki-default:#B392F0"> useAsyncData</span><span style="--shiki-default:#E1E4E8">(slug, () </span><span style="--shiki-default:#F97583">=&gt;</span><span style="--shiki-default:#B392F0"> queryContent</span><span style="--shiki-default:#E1E4E8">())
</span></span><span class="line" line="4"><span style="--shiki-default:#E1E4E8">&lt;/</span><span style="--shiki-default:#85E89D">script</span><span style="--shiki-default:#E1E4E8">&gt;
</span></span></code><!--]--></pre></div></div><p><!--[-->那如果要從陣列一次平行調用很多的<code class=""><!--[-->queryContent<!--]--></code>呢？例如我從自定義的數個文章分類要一次平行查詢，那就要用<code class=""><!--[-->Promise.all<!--]--></code>把他們包裝起來，然後<code class=""><!--[-->await<!--]--></code>這個<code class=""><!--[-->Promise.all<!--]--></code>（這真的滿反直覺的……而且文件都沒寫 QQ），像這樣：<!--]--></p><div class="position-relative language-vue shiki shiki-themes github-dark" code="&lt;script setup&gt;
const { data: categories } = await useAsyncData(&#39;categories&#39;, async () =&gt; {
  await Promise.all(
    Object.keys(categories).map((category) =&gt; queryContent().find())
  )

  return categories
})
&lt;/script&gt;
" meta style=""><div class="d-flex flex-row align-items-center text-white py-2 px-3 rounded-top bg-secondary"><div class="flex-grow-1 text-truncate pe-3 small fw-bold font-monospace"></div><button class="btn-link btn p-0 d-flex align-items-center justify-content-center text-white" type="button"><!--[--><i class="bi-clipboard"></i><!--]--></button></div><div class="rounded-bottom bg-black"><pre class="_code_bvtnx_2"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E1E4E8">&lt;</span><span style="--shiki-default:#85E89D">script</span><span style="--shiki-default:#B392F0"> setup</span><span style="--shiki-default:#E1E4E8">&gt;
</span></span><span class="line" line="2"><span style="--shiki-default:#F97583">const</span><span style="--shiki-default:#E1E4E8"> { </span><span style="--shiki-default:#FFAB70">data</span><span style="--shiki-default:#E1E4E8">: </span><span style="--shiki-default:#79B8FF">categories</span><span style="--shiki-default:#E1E4E8"> } </span><span style="--shiki-default:#F97583">=</span><span style="--shiki-default:#F97583"> await</span><span style="--shiki-default:#B392F0"> useAsyncData</span><span style="--shiki-default:#E1E4E8">(</span><span style="--shiki-default:#9ECBFF">&#39;categories&#39;</span><span style="--shiki-default:#E1E4E8">, </span><span style="--shiki-default:#F97583">async</span><span style="--shiki-default:#E1E4E8"> () </span><span style="--shiki-default:#F97583">=&gt;</span><span style="--shiki-default:#E1E4E8"> {
</span></span><span class="line" line="3"><span style="--shiki-default:#F97583">  await</span><span style="--shiki-default:#79B8FF"> Promise</span><span style="--shiki-default:#E1E4E8">.</span><span style="--shiki-default:#B392F0">all</span><span style="--shiki-default:#E1E4E8">(
</span></span><span class="line" line="4"><span style="--shiki-default:#E1E4E8">    Object.</span><span style="--shiki-default:#B392F0">keys</span><span style="--shiki-default:#E1E4E8">(categories).</span><span style="--shiki-default:#B392F0">map</span><span style="--shiki-default:#E1E4E8">((</span><span style="--shiki-default:#FFAB70">category</span><span style="--shiki-default:#E1E4E8">) </span><span style="--shiki-default:#F97583">=&gt;</span><span style="--shiki-default:#B392F0"> queryContent</span><span style="--shiki-default:#E1E4E8">().</span><span style="--shiki-default:#B392F0">find</span><span style="--shiki-default:#E1E4E8">())
</span></span><span class="line" line="5"><span style="--shiki-default:#E1E4E8">  )
</span></span><span class="line" line="6"><span emptylineplaceholder="true">
</span></span><span class="line" line="7"><span style="--shiki-default:#F97583">  return</span><span style="--shiki-default:#E1E4E8"> categories
</span></span><span class="line" line="8"><span style="--shiki-default:#E1E4E8">})
</span></span><span class="line" line="9"><span style="--shiki-default:#E1E4E8">&lt;/</span><span style="--shiki-default:#85E89D">script</span><span style="--shiki-default:#E1E4E8">&gt;
</span></span></code><!--]--></pre></div></div><hr><h2 id="後記"><!--[-->後記<!--]--></h2><p><!--[-->Nuxt Content 的部份大概就是這樣，除了踩了一個坑以外大致都還行，後面在升級其他模組時也有踩到一些坑，雖然覺得耗費心神，但踩坑也代表學了點新東西（吧）。<!--]--></p><style>html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div></article><!--]--></div><hr class="d-sm-none d-block"><a href="https://ko-fi.com/chaoschaoshuang" target="_blank" rel="noopener noreferrer " class="mt-5 d-flex justify-content-center"><!--[--><img src="/blog/images/donation/kofi_button_blue.png" alt="Support me on Ko-fi" class="img-fluid d-block" width="200"><!--]--></a><div class="giscus mt-5"></div><div class="mt-5"><div class="h5 mb-4 text-center"> 相關文章 </div><!--[--><article class="d-flex flex-column align-items-stretch rounded flex-sm-row _card_iqejw_2 mt-3"><div class="order-sm-1 px-sm-4 d-flex flex-column flex-grow-1 px-3 py-3 order-2"><div class="_content_iqejw_30"><h4 class="_title_iqejw_30 text-body text-line-2">部落格Nuxt 2升級Nuxt 3（一）：bootstrapVue置換成自製的bootrap5元件</h4><p class="_description_iqejw_24 text-muted text-line-2" title="如之前規劃，部落格升級 Nuxt3 的第一步是先把 bootstrapVue 抽換成自己實做的 bootstrap5。這篇是紀錄過程中覺得特別困難或是需要研究的部份。">如之前規劃，部落格升級 Nuxt3 的第一步是先把 bootstrapVue 抽換成自己實做的 bootstrap5。這篇是紀錄過程中覺得特別困難或是需要研究的部份。</p></div><div class="mt-sm-3 d-flex flex-row align-items-center"><time class="d-flex align-items-center flex-row text-muted small mb-0 small"><!--[--><i class="bi-pencil-square me-1"></i><span class="me-3">2024/01/24</span><!--]--></time><span class="text-muted small d-inline-flex align-items-center"><i class="bi-clock me-1"></i><span class="me-3">4 min</span></span><!----><div class="text-end flex-grow-1"><a href="/blog/nuxt2_to_nuxt3_blog_1_ui/" class="btn-primary btn-sm btn d-inline-flex flex-row align-items-center _btn_1w7mw_2"><!--[--><!--[--> 閱讀更多 <!--]--><i class="bi-arrow-right _icon_1w7mw_2"></i><!--]--></a></div></div></div><div class="position-relative align-self-stretch order-1 order-sm-2 _banner_iqejw_20"><img srcset="https://imagizer.imageshack.com/v2/100x75q70/924/Ia2nWi.png 100w, https://imagizer.imageshack.com/v2/150x100q70/924/Ia2nWi.png 150w, https://imagizer.imageshack.com/v2/280x200q70/924/Ia2nWi.png 280w, https://imagizer.imageshack.com/v2/320x240q70/924/Ia2nWi.png 320w, https://imagizer.imageshack.com/v2/640x480q70/924/Ia2nWi.png 640w, https://imagizer.imageshack.com/v2/800x600q70/924/Ia2nWi.png 800w, https://imagizer.imageshack.com/v2/1024x768q70/924/Ia2nWi.png 1024w, https://imagizer.imageshack.com/v2/1280x1024q70/924/Ia2nWi.png 1280w, https://imagizer.imageshack.com/v2/1600x1200q70/924/Ia2nWi.png 1600w" class="_img_5u372_2 _img_iqejw_34" loading="lazy"></div></article><article class="d-flex flex-column align-items-stretch rounded flex-sm-row _card_iqejw_2 mt-3"><div class="order-sm-1 px-sm-4 d-flex flex-column flex-grow-1 px-3 py-3 order-2"><div class="_content_iqejw_30"><h4 class="_title_iqejw_30 text-body text-line-2">部落格Nuxt 2升級Nuxt 3：前言</h4><p class="_description_iqejw_24 text-muted text-line-2" title="從去年年初開始建置的這個部落格網站，邊寫文章的同時陸陸續續補上功能後，大概到上個月才終於像是有個部落格的樣子。但由於 Nuxt2 即將在 2024/06/30 停止官方支援，而作為基底的 Vue2 更是在 2023/12/31 已停止官方支援，所以……想說要做的新功能可能先放著，先把部落格從 Nuxt2 升級到 Nuxt3 比較好。">從去年年初開始建置的這個部落格網站，邊寫文章的同時陸陸續續補上功能後，大概到上個月才終於像是有個部落格的樣子。但由於 Nuxt2 即將在 2024/06/30 停止官方支援，而作為基底的 Vue2 更是在 2023/12/31 已停止官方支援，所以……想說要做的新功能可能先放著，先把部落格從 Nuxt2 升級到 Nuxt3 比較好。</p></div><div class="mt-sm-3 d-flex flex-row align-items-center"><time class="d-flex align-items-center flex-row text-muted small mb-0 small"><!--[--><i class="bi-pencil-square me-1"></i><span class="me-3">2024/01/24</span><!--]--></time><span class="text-muted small d-inline-flex align-items-center"><i class="bi-clock me-1"></i><span class="me-3">5 min</span></span><!----><div class="text-end flex-grow-1"><a href="/blog/nuxt2_to_nuxt3_blog_0_intro/" class="btn-primary btn-sm btn d-inline-flex flex-row align-items-center _btn_1w7mw_2"><!--[--><!--[--> 閱讀更多 <!--]--><i class="bi-arrow-right _icon_1w7mw_2"></i><!--]--></a></div></div></div><div class="position-relative align-self-stretch order-1 order-sm-2 _banner_iqejw_20"><img srcset="https://imagizer.imageshack.com/v2/100x75q70/924/Ia2nWi.png 100w, https://imagizer.imageshack.com/v2/150x100q70/924/Ia2nWi.png 150w, https://imagizer.imageshack.com/v2/280x200q70/924/Ia2nWi.png 280w, https://imagizer.imageshack.com/v2/320x240q70/924/Ia2nWi.png 320w, https://imagizer.imageshack.com/v2/640x480q70/924/Ia2nWi.png 640w, https://imagizer.imageshack.com/v2/800x600q70/924/Ia2nWi.png 800w, https://imagizer.imageshack.com/v2/1024x768q70/924/Ia2nWi.png 1024w, https://imagizer.imageshack.com/v2/1280x1024q70/924/Ia2nWi.png 1280w, https://imagizer.imageshack.com/v2/1600x1200q70/924/Ia2nWi.png 1600w" class="_img_5u372_2 _img_iqejw_34" loading="lazy"></div></article><article class="d-flex flex-column align-items-stretch rounded flex-sm-row _card_iqejw_2 mt-3"><div class="order-sm-1 px-sm-4 d-flex flex-column flex-grow-1 px-3 py-3 order-2"><div class="_content_iqejw_30"><h4 class="_title_iqejw_30 text-body text-line-2">部落格Nuxt 2升級Nuxt 3（六）：Vuex → Pinia</h4><p class="_description_iqejw_24 text-muted text-line-2" title="Nuxt 3 的狀態管理套件從 Nuxt 2 的 Vuex 改成了 Pinia，兩者差異不算大，部落格用到的功能也不多。其中比較要注意的就是 Nuxt 3 不再提供nuxtServerInit方法，若需要在 server 端初始化一些資料的話，就要透過其他作法來完成。">Nuxt 3 的狀態管理套件從 Nuxt 2 的 Vuex 改成了 Pinia，兩者差異不算大，部落格用到的功能也不多。其中比較要注意的就是 Nuxt 3 不再提供nuxtServerInit方法，若需要在 server 端初始化一些資料的話，就要透過其他作法來完成。</p></div><div class="mt-sm-3 d-flex flex-row align-items-center"><time class="d-flex align-items-center flex-row text-muted small mb-0 small"><!--[--><i class="bi-calendar-event me-1"></i><span class="me-3">2024/01/24</span><!--]--></time><span class="text-muted small d-inline-flex align-items-center"><i class="bi-clock me-1"></i><span class="me-3">5 min</span></span><!----><div class="text-end flex-grow-1"><a href="/blog/nuxt2_to_nuxt3_blog_6_modules_pinia/" class="btn-primary btn-sm btn d-inline-flex flex-row align-items-center _btn_1w7mw_2"><!--[--><!--[--> 閱讀更多 <!--]--><i class="bi-arrow-right _icon_1w7mw_2"></i><!--]--></a></div></div></div><div class="position-relative align-self-stretch order-1 order-sm-2 _banner_iqejw_20"><img srcset="https://imagizer.imageshack.com/v2/100x75q70/924/Ia2nWi.png 100w, https://imagizer.imageshack.com/v2/150x100q70/924/Ia2nWi.png 150w, https://imagizer.imageshack.com/v2/280x200q70/924/Ia2nWi.png 280w, https://imagizer.imageshack.com/v2/320x240q70/924/Ia2nWi.png 320w, https://imagizer.imageshack.com/v2/640x480q70/924/Ia2nWi.png 640w, https://imagizer.imageshack.com/v2/800x600q70/924/Ia2nWi.png 800w, https://imagizer.imageshack.com/v2/1024x768q70/924/Ia2nWi.png 1024w, https://imagizer.imageshack.com/v2/1280x1024q70/924/Ia2nWi.png 1280w, https://imagizer.imageshack.com/v2/1600x1200q70/924/Ia2nWi.png 1600w" class="_img_5u372_2 _img_iqejw_34" loading="lazy"></div></article><!--]--></div></div><!--]--><!--]--></main><footer class="pb-5 _footer_4zxf0_2 mt-4"><div class="container container-sm text-white"><!--[--><div class="row"><!--[--><div class="col-sm-4 col-12 mt-5"><!--[--><div class="fw-bold mb-2 d-flex align-items-center h6 text-primary"><!--[--><a href="/blog/buy_me_a_tea#%E9%97%9C%E6%96%BC%E6%88%91" class="text-primary">關於我</a><!--[--><img src="/blog/pwa-64x64.png" height="16" width="16" class="common-icon rounded-circle shadow-sm ms-2"><!--]--><!--]--></div><div class="small"><!--[--><!--[--> 工作時若不喝上一杯飲料就無法做事的前端小碼農。三大前端框架陣營中屬於 Vue 陣營。 <!--]--><!--]--></div><!--]--></div><div class="col-sm-4 col-12 mt-5"><!--[--><div class="fw-bold mb-2 d-flex align-items-center h6 text-primary"><!--[--><a href="/blog/buy_me_a_tea#%E9%97%9C%E6%96%BC%E9%9A%A8%E6%A9%9F%E6%89%8B%E6%9C%AD" class="text-primary">關於隨機手札</a><!--[--><!--]--><!--]--></div><div class="small"><!--[--><!--[--> 使用 <a href="https://v2.nuxt.com/" target="_blank" rel="noopener noreferrer " class="text-white"><!--[--><!--[--> Nuxt 2 <!--]--><!--]--></a> 建置於 <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer " class="text-white"><!--[--><!--[--> Github Pages <!--]--><!--]--></a> 上，全站文字皆在 <a href="https://creativecommons.org/licenses/by-nd/4.0/legalcode.zh-hant" target="_blank" rel="noopener noreferrer " class="text-white"><!--[--><!--[--> 創用CC BY-ND 4.0 條款 <!--]--><!--]--></a> 下提供。 <!--]--><!--]--></div><!--]--></div><div class="col-sm-4 col-12 mt-5"><!--[--><div class="fw-bold mb-2 d-flex align-items-center h6 text-primary"><!--[--><a href="/blog/buy_me_a_tea#%E8%AB%8B%E6%88%91%E5%96%9D%E6%9D%AF%E6%89%8B%E6%90%96%E9%A3%B2%E5%90%A7%EF%BC%81" class="text-primary">請我喝杯手搖飲吧！</a><!--[--><!--]--><!--]--></div><div class="small"><!--[--><!--[--> 若這裡的經驗分享有幫助到你，可以透過<a href="https://ko-fi.com/chaoschaoshuang" target="_blank" rel="noopener noreferrer " class="text-white"><!--[--><!--[--> Ko-fi <!--]--><!--]--></a>請我喝杯手搖飲哦！ <!--]--><!--]--></div><!--]--></div><!--]--></div><!--]--></div></footer><!--]--><!--teleport start--><!--teleport end--><!--]--></div><div id="teleports"></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true" data-src="/blog/nuxt2_to_nuxt3_blog_3_modules_content/_payload.json?f8fe5c8d-7029-4cbc-9230-200c4a607a00">[{"state":1,"once":7,"_errors":9,"serverRendered":12,"path":13,"pinia":14,"prerenderedAt":64},["Reactive",2],{"$ssite-config":3},{"env":4,"name":5,"url":6},"production","blog","https://huangchingchieh.github.io",["Reactive",8],["Set"],["Reactive",10],{"search:":11,"nuxt2_to_nuxt3_blog_3_modules_content":11,"titleMap":11,"titleMap:":11,"articles":11,"title|nuxt2_to_nuxt3_blog_2_settings":11,"title|nuxt2_content_git":11,"title|nuxt2_content_code_block_copy_paste":11},null,true,"/nuxt2_to_nuxt3_blog_3_modules_content/",["Reactive",15],{"main":16,"theme":63},{"tagsObj":17,"categories":18,"articlesMetadata":29,"toc":30},{},{"life":19,"frontend":22,"linux":24,"all":26},{"count":20,"pageCount":21},17,2,{"count":23,"pageCount":21},14,{"count":25,"pageCount":21},15,{"count":27,"pageCount":28},46,5,{"count":27,"pageCount":28},[31,41,43,46,48,51,58,61],{"id":32,"depth":21,"text":32,"children":33},"相關資料夾結構修改",[34,38],{"id":35,"depth":36,"text":37},"content-資料夾",3,"content 資料夾",{"id":39,"depth":36,"text":40},"componentsglobal-componentscontent","components/global → components/content",{"id":42,"depth":21,"text":42},"nuxt-content-git",{"id":44,"depth":21,"text":45},"為文章新增-reading-time","為文章新增 reading-time",{"id":47,"depth":21,"text":47},"自定義元件",{"id":49,"depth":21,"text":50},"自行補上-slug","自行補上 slug",{"id":52,"depth":21,"text":52,"children":53},"未穩定的搜尋功能",[54,56],{"id":55,"depth":36,"text":55},"啟用搜尋功能",{"id":57,"depth":36,"text":57},"搜尋文章寫法",{"id":59,"depth":21,"text":60},"querycontent-與-useasyncdata-的眉角","queryContent 與 useAsyncData 的眉角",{"id":62,"depth":21,"text":62},"後記",{"dark":11,"preferDark":12},1713192593435]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{base:"/blog/",imageServer:"https://imagizer.imageshack.com/v2/",appHost:"https://huangchingchieh.github.io/blog/",perPage:10,categoriesMap:{all:"最新文章",linux:"Linux心得",frontend:"前端筆記",life:"生活雜記"},description:"一個非本科系的前端小碼農，紀錄一些身為前端小碼農的技術筆記、使用Linux（主要是Fedora）的心得，以及生活上雜七雜八的事情。",isDev:false,mdc:{components:{prose:true,map:{p:"prose-p",a:"ArticleOuterLink",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr",pre:"ArticleCode"}},headings:{anchorLinks:{h1:false,h2:false,h3:false,h4:false,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1713192511082,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:[]},tags:{p:"prose-p",a:"ArticleOuterLink",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr",pre:"ArticleCode"},highlight:{theme:"github-dark"},wsUrl:"",documentDriven:false,host:"",trailingSlash:false,search:{indexed:true,ignoredTags:["style","code"],filterQuery:{_draft:false,_partial:false},options:{fields:["title","content","titles"],storeFields:["title","content","titles"],searchOptions:{prefix:true,fuzzy:.2,boost:{title:4,content:2,titles:1}}}},contentHead:true,anchorLinks:false}},app:{baseURL:"/blog/",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>